
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>车水马龙</title>
  <meta name="author" content="Sun Ning">

  
  <meta name="description" content="今天凌晨Ubuntu 9.10 Karmic的beta发布了，实在忍耐不到月底了，上午就update-manager -d升级了发行版。从下在到安装完成用了大约三个小时，当然升级不用花什么精力，只要让程序自动去处理就好了，现在跨版本升级越来越轻松了。 配好以后感觉还是很值得升级的， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sunng87.github.io/blog//blog/page/33">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/blog/atom.xml" rel="alternate" title="车水马龙" type="application/atom+xml">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">车水马龙</a></h1>
  
    <h2>here comes the sun</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:sunng87.github.io/blog/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/10/02/upgrade-to-karmic/">Upgrade to Karmic</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-02T00:00:00+08:00" pubdate data-updated="true">Oct 2<span>nd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今天凌晨Ubuntu 9.10 Karmic的beta发布了，实在忍耐不到月底了，上午就update-manager -d升级了发行版。从下在到安装完成用了大约三个小时，当然升级不用花什么精力，只要让程序自动去处理就好了，现在跨版本升级越来越轻松了。</p>

<p>配好以后感觉还是很值得升级的，大概多半是因为Kernel 2.6.31，这次桌面性能的提升真的非常大，之前从来没有这么明显的感受。举个例子，很惭愧，我这机器在上一个9.04版本里alt-table的Application Switcher都还会卡，现在已经一如之前不开compositing时的性能了。</p>

<p>既然是ubuntu，还是要提一下面子上的事情。GDM有变化，按照release notes上说的是全部重写了。在从gdm登录到桌面载入之间有了一个loading效果，体验很不错。然后是Ubuntu主题变了，human不再是黄的了，变成了深褐色，有了新的图标主题humanity，尤其是在桌面的右上角区域很有特点。</p>

<p>再有就是Gnome2.28的变化还有Ubuntu对gnome相关的增强了，这次激进了一些，居然赶在arch更新之前在ubuntu上体验了gnome的新版本。主要有几个变化：</p>

<p>indicator变得更强大了，现在indicator和evolution empathy gwibber等等软件有了更好的集成，在indicator-applet里可以看到这些软件的新消息通知，另外indicator和原来Ubuntu的session manager也集成了，可以通过session manager设置empathy的状态。</p>

<p>empathy变化很大，据说已经支持xmpp的geolocation extension了，早先我就转载过一个在osm上显示xmpp好友位置的截图。不过这个功能似乎又没有在ubuntu的版本里找到，可能ubuntu这边还是有点谨慎吧。倒是geoclue这个框架已经被加进apt-get了，可以看出相关的工作确实是在进行中。</p>

<p>epiphany开始用webkit内核了，这样可以把midori彻底踢开了，epiphany也算是找到了自己在linux桌面上存在的意义。empathy可以抢走pidgin的位置，epiphany想强firefox的位置还是挺难的。</p>

<p>还有Ubuntu似乎修改了gnome桌面gnome-panel/panel-menu-item.c里面的参数，之前当places里的书签数大于5之后会产生一个Bookmarks子菜单，现在这个数值似乎变成了8，当然只是猜测，因为gnome的代码里这个值仍然是5。发现这个变化的过程实在比较无聊。。。</p>

<p>据说2.28的Evince看书的时候记annotation了，不过我好像没有发现这个功能，Gnome的release notes上也只是提了一下并没有发截图。</p>

<p>我还是很感激每半年就有很多新特性可以去discover的，这种感觉很不错。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/09/30/a-shorten-url-app/">A Shorten Url App</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-30T00:00:00+08:00" pubdate data-updated="true">Sep 30<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>一不小心又是大概有一年多时间没有用过Django了。最近经常有之前部门的同事来讨论Django和Python Web开发，大概是他们用asp做的客服系统终于要换架构了。今天国庆提前放假，用了一个下午的时间重温一下。Django的Template还是相对弱一些，居然无法在template里调用model的方法。这样auth模块里判断用户登录的is_authticated()方法就不能在template里调，如此非得在view判断（Django是MTV模型，它的view即MVC里的controller），那如果是用generic_view，这个似乎就无解了？？</p>

<p>贴个图。体验一下Firefox3.5开始支持的@font-face，Webkit核心和Opera浏览器都支持这个功能。不过我Ubuntu上的Midori貌似遇到Mootools就直接崩溃，看来要等到gnome2.28里epiphany了。<img class="alignnone" src="http://pic.yupoo.com/classicning/65666826c591/medium.jpg" alt="" width="500" height="365" /></p>

<p>忘了提了，域名是我yy的，之所以有这样的效果是修改了hosts</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/09/29/%E9%A6%96%E9%A1%B5%E6%9B%B4%E6%96%B0/">首页更新</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-29T00:00:00+08:00" pubdate data-updated="true">Sep 29<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>半年没碰那个首页了，最近看到commandlinefu提供了jsonp接口，顺手把commandlinefu加了进来：
<em>Classicning7.clifu();</em></p>

<p>这个程序是去年此时还在用JavaScript工作的时候写的，隔了一年再看，很难不感慨啊。话说，大家要是发现一些好玩的，好用的JSONP服务可以分享一下。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/09/27/0-2/">0:2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-27T00:00:00+08:00" pubdate data-updated="true">Sep 27<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>以下是今天的闲言碎语。
<ol>
	<li>其实中超真挺好看的，我不是说球，纯技术的欣赏还是交给伪球迷吧。群雄逐鹿，乱七八糟，踢球的踢球，骂人的骂人。<a href="http://sports.sina.com.cn/j/2009-09-27/14304607690.shtml" target="_blank">广州的徐亮</a>应该算是现在国内足坛最TM有个性的球员了，有点当年范志毅郝海东的意思了，可惜这样的球员还是少，多点的话就更热闹了。舜天队还是那个样子，今天的比赛看了半场，也不像是不想赢，但是派个<a href="http://www.rodolfoalemao.com.br/" target="_blank">傻大个</a>在前面挥霍机会，难道是轻敌了？下半场据说是风云突变，反正最后黑色三分钟，就冲这个架势，看来夺冠还是纯YY。</li>
	<li>办人事档案的手续，发现同样是纳爱斯，也有真纳爱斯和假纳爱斯，或者说是伪纳爱斯。同样是春风，有的是吹面不寒杨柳风，有的是二月春风似剪刀，后者用范伟的话说，咔咔的。说来说去还是家乡人淳朴，不像那个哪，看谁都跟骗子一样。</li>
	<li>看建国大业了，豆瓣上有个说法叫视频幻灯片，很典型。印象深的，除了某幕后人员，配角里就属最后刘德华，因为看了两遍。国军衣服就是好看，当时那张脸就是典型的“如果说一切都是天意一切都是命运很早已注定”，苦啊，在肚子里。不说电影本身了，倒是想想这个事情，从井冈山被打得到处跑，到胡宗南占了延安又是到处跑，无数的挫折、看似没有希望，从一开始到最后成功漫长的20年，且不跟你们讨论这件事到底怎么样，但是把它当成一个人或者说一个团体的事业，实在是壮观壮丽。</li>
	<li>回上海，在火车站看到广告说“学习北京奥运会，办好上海世博会”，说实在的，真学的话，要是地铁能两块钱随便坐，全国人民也请上海人民和上海黑户坐一年地铁那是最好了。估计是不可能了，怎么办，唯有调整心态：话说我每天都请北京的谁谁还有谁谁谁坐地铁坐公交，有这种心态，刷卡过闸机的时候动作会相对潇洒一些。</li>
	<li>工作那边，要准备申请立个项目，项目的点子是部门的负责人想的，咱来do it。让个应届生当PM又不靠谱，架构师来挂个名，可是人家忙得要死，只能深情款款地对我说，开发暂时就你一个人。现在项目组变成运维、测试、项管群殴我一个，就着这两天的所见所闻，大约也能想象今年剩下几个月的日子。</li>
	<li>又到了一年一度的recruitment，看着大家跃跃欲试，我在这里祝大家过得比我好。</li>
</ol>
洗完澡回来补一枪，上周买了一本<a href="http://www.douban.com/subject/3924175/" target="_blank">这个</a>，周五在火车上看了前面一两章，感觉还不错，尤其是压力测试方面解决了我最近的一些疑问。同时我也感觉到写这么一本书确实要有一大瓶水和可观的时间和精力，这个还是很难的。熟悉俺的人都知道出本误人子弟的书是俺长久以来的梦想，不过看了<a href="http://bbs.51js.com/viewthread.php?tid=85328&amp;extra=&amp;page=1" target="_blank">这位28本书的作者</a>的状况，我这个梦想离照进现实还是有距离的。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/09/24/performance-visualization-with-gnuplot-continued/">Performance Visualization With Gnuplot, Continued</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-24T00:00:00+08:00" pubdate data-updated="true">Sep 24<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After I post my command to <a href="http://www.commandlinefu.com/" target="_blank">commandlinefu.com</a>, there is an alternative command followed:
<em>(echo &#8220;set terminal png;plot &#8216;-&#8217; u 1:2 t &#8216;cpu&#8217; w linespoints;&#8221;; sudo vmstat 2 10 | awk &#8216;NR &gt; 2 {print NR, $13}&#8217;) | gnuplot &gt; plot.png</em></p>

<p>This one is appreciated for using pipes and redirection. It works on Ubuntu Jaunty, on which, gnuplot doesn&#8217;t provide a -e option. The author also showed an link to an open source project &#8216;vmplot&#8217; on <a href="http://freshmeat.net/projects/vmplot/" target="_blank">freshmeat</a>. Vmplot is written in python, which combines parameters with scripts and end up with an os.system call. Grab the source from <a href="http://elvis.elte.hu/~fuji/stuff/vmplot.py" target="_blank">here</a>. (Why use python instead on a simple bash command? because it&#8217;s difficult to draw a multiplot without temp file or variables, you cannot read &#8216;-&#8217; twice.)</p>

<p>There are several people vote me down for my command! It must be primers whose use ubuntu and knows the world via Synaptic only, because they failed to run the command on their dated machine (*_*)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/09/23/performance-visualization-with-gnuplot/">Performance Visualization With Gnuplot</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-23T00:00:00+08:00" pubdate data-updated="true">Sep 23<span>rd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Gnuplot is considered to be one of the most famous plotting tools on both linux and windows. With Gnuplot, generation of charts becomes agile and easy. Gnuplot supports sorts of terminals range from gui, image to printer. To enable png terminal support, we will build gnuplot with following steps. (However, on most linux distributions you don&#8217;t have to do these manually, install gnuplot with package manager is doubtlessly the best choice for most cases.)</p>

<p>Well, for a naked machine, it won&#8217;t be too long to type commands in gnuplot.
<h3>Installing libpng</h3>
linpng provides functionality to write png images.<br />
Grab source form libpng&#8217;s website:
<em>wget http://downloads.sourceforge.net/project/libpng/00-libpng-stable/1.2.39/libpng-1.2.39.tar.gz?use_mirror=ncu</em></p>

<p>Uncompress the package:
<em>tar xfz libpng-1.2.39.tar.gz</em></p>

<p>cd to result directory and build it:
<em>cd libpng-1.2.39<br />
./configure<br />
make<br />
make install</em>
<h3>Installing libgd</h3>
gd provides api for programmer to draw images like Graphics2d in java. Gnuplot uses gd to draw charts on images.<br />
Grab source from gd&#8217;s website:
<em>wget http://www.libgd.org/releases/gd-2.0.35.tar.gz</em></p>

<p>Uncompress it:
<em>tar xfz gd-2.0.35.tar.gz</em></p>

<p>build it:
<em>cd gd-2.0.35<br />
./configure<br />
make<br />
make install</em>
<h3>Compiling and building Gnuplot</h3>
Grab source from sourceforge:
<em>wget http://downloads.sourceforge.net/project/gnuplot/gnuplot/4.2.6/gnuplot-4.2.6.tar.gz?use_mirror=ncu</em></p>

<p>Uncompress and compile:
<em>tar xfz gnuplot-4.2.6.tar.gz<br />
cd gnuplot<br />
./configure<br />
make<br />
make install</em></p>

<p>if &#8221;<em>&#8216;@LIBICONV@&#8217; not found</em>&#8221; encountered during make, just edit <em>src/Makefile</em> to replace <em>-l@LIBICONV@</em> to <em>-liconv</em>, and make again.<br />
Try to start gnuplot simply with:
<em>gnuplot</em></p>

<p>Now you may be stopped by error message like<em> libiconv.so.2</em> not found, then you have to copy it from somewhere(such as<em> /usr/local/lib</em>) to<em> /usr/lib</em>, the it will work.
<h3>Using Gnuplot</h3>
As the installation completed, we start to use it.</p>

<p>vmstat is a great utility shows you the status of your process queue, memory, swap, io rates, interrupts and cpu usage. With command-line arguments, we can dump these data in a fixed interval and fixed count:
<em>vmstat 5 10</em></p>

<p>awk is a well-known editor to analyze and extract text from input, we can filter specified fields with awk like this:
<em>vmstat 5 10 | awk &#8216;NR &gt; 2 {print NR-2, $13}&#8217;</em>
The header was ignored by the conditional expression NR&gt;2 which NR stands for Number-of-Row</p>

<p>The output is just enough for gnuplot, now use pipe to connect them together:
<em>vmstat 5 10 | awk &#8216;NR &gt; 2 {print NR, $13}&#8217; | gnuplot -e &#8220;set terminal png; set output &#8216;v.png&#8217;; plot &#8216;-&#8217; u 1:2 t &#8216;cpu&#8217; w linespoints;&#8221;</em></p>

<p>To gather more information at one time, a more complex command is needed:
<em>vmstat 10 360 | awk &#8216;NR &gt; 2 {print NR, $4, $9, $10, $13}&#8217; &gt; vmstat.dat ; gnuplot -e &#8220;set terminal png;set output &#8216;vmstat.png&#8217;;set grid; set multiplot;set size 0.5, 0.5;set origin 0, 0;plot &#8216;vmstat.dat&#8217; u 1:2 t &#8216;freemem&#8217; w linespoints;set size 0.5, 0.5;set origin 0.5, 0;plot &#8216;vmstat.dat&#8217; u 1:3 t &#8216;bi&#8217; w linespoints;set size 0.5, 0.5;set origin 0, 0.5;plot &#8216;vmstat.dat&#8217; u 1:4 t &#8216;bo&#8217; w linespoints;set size 0.5, 0.5;set origin 0.5, 0.5;plot &#8216;vmstat.dat&#8217; u 1:5 t &#8216;cpu&#8217; w linespoints;unset multiplot;&#8221;</em></p>

<p>Unfortunately, gnuplot in Ubuntu jaunty is at version of 4.2.4, which doesn&#8217;t support -e option. So you cannot send gnuplot commands directly in command-line. The solution is split it to several steps:
<em>vmstat 10 360 | awk &#8216;NR &gt; 2 {print NR, $4, $9, $10, $13}&#8217; &gt; vmstat.dat<br />
gnuplot<br />
&gt;set terminal png;<br />
&gt;set output &#8216;vmstat.png&#8217;;<br />
&gt;set grid;<br />
&gt;set multiplot;<br />
&gt;set size 0.5, 0.5;<br />
&gt;set origin 0, 0;<br />
&gt;plot &#8216;vmstat.dat&#8217; u 1:2 t &#8216;freemem&#8217; w linespoints;<br />
&gt;set size 0.5, 0.5;<br />
&gt;set origin 0.5, 0;<br />
&gt;plot &#8216;vmstat.dat&#8217; u 1:3 t &#8216;bi&#8217; w linespoints;<br />
&gt;set size 0.5, 0.5;<br />
&gt;set origin 0, 0.5;plot &#8216;vmstat.dat&#8217; u 1:4 t &#8216;bo&#8217; w linespoints;<br />
&gt;set size 0.5, 0.5;<br />
&gt;set origin 0.5, 0.5;<br />
&gt;plot &#8216;vmstat.dat&#8217; u 1:5 t &#8216;cpu&#8217; w linespoints;<br />
&gt;unset multiplot;</em></p>

<p>This picture is a stat result of performance test this afternoon</p>

<p><img class="alignnone" src="http://pic.yupoo.com/classicning/3794181d957c/medium.jpg" alt="" width="500" height="375" /></p>

<p>For more detailed tutorials, check the article on ibm dw:
<a href="http://www.ibm.com/developerworks/library/l-gnuplot/" target="_blank">http://www.ibm.com/developerworks/library/l-gnuplot/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/09/22/some-python-segments/">Some Python Segments</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-22T00:00:00+08:00" pubdate data-updated="true">Sep 22<span>nd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><pre class="brush:python">
import MySQLdb
import subprocess
from smtplib import *
from datetime import date, timedelta</pre></p>

<p>class StatEntry(object):<br />
    def __init__(self, name, count):<br />
        self.name = name<br />
        self.count = count<br />
    def __str__(self):<br />
        return &#8220;%s\t%d&#8221; % (self.name, self.count)</p>

<p>def fetchdb(date):<br />
    conn = MySQLdb.connect(host=&#8221;localhost&#8221;, user=&#8221;root&#8221;, passwd=&#8221;acd&#8221;, db=&#8221;cls&#8221;)<br />
    cursor = conn.cursor()<br />
    cursor.execute(&#8220;SELECT link, count(*) FROM sdocom WHERE DATE(logtime) = DATE(&#8216;%s&#8217;) GROUP BY link&#8221; % date)<br />
    rows = cursor.fetchall()<br />
    result = map(lambda x: StatEntry(*x), rows)<br />
    return result</p>

<p>def archive(datelist):<br />
    for date in datelist:<br />
        subprocess.call([&#8220;gzip&#8221;, &#8220;cls-&#8220;+date+&#8221;.log&#8221;])</p>

<p>def sendmail(results):<br />
    mailcontent = reduce(lambda x,y: x+str(y)+&#8221;\n&#8221;, results, &#8220;&#8221;)<br />
    smtp = SMTP(&#8220;your.smtp.server&#8221;)<br />
    smtp.login(&#8220;user&#8221;,&#8221;passwd&#8221;)<br />
    smtp.sendmail(&#8220;cls-no-reply@smtp.server&#8221;, [&#8220;your@mail.server&#8221;], mailcontent)<br />
    smtp.quit()</p>

<p>def dumpall(data):<br />
    content = reduce(lambda x,y: x+str(y)+&#8221;\n&#8221;, data, &#8220;&#8221;)<br />
    print content</p>

<p>def main():<br />
    yesterday = str(date.today()-timedelta(1))<br />
    results = fetchdb(yesterday)<br />
    #dumpall(results)<br />
    sendmail(results)<br />
    archive([yesterday])</p>

<p>if __name__ == &#8216;__main__&#8217;:<br />
    main()
</p>

<p>As log file was imported to database automatically by other process, the script retrieves statistical data from mysql db and sends the result to your mail box via smtp. Also, log file would be compressed by gzip to minimize storage overhead. Add it to crontab, you will get daily statistical report.</p>

<p>This example shows you basic usage of mysql-python lib, smtplib and how to calculate yesterday by datetime.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/09/20/%E7%83%A7%E9%A5%AD%E5%86%8D/">烧饭再</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-20T00:00:00+08:00" pubdate data-updated="true">Sep 20<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://blog.samsonis.me/2009/09/update-20/" target="_blank">看了烧饭1，就想看烧饭2</a>.可是我思前想后，烧饭2这个标题总有那么一点不太对劲（大家自己体会），于是还是叫烧饭再吧。</p>

<p>今天介绍酱爆鸡丁，娘的，在北京的夏天吃这个吃得都快吐了，时隔一年本人亲自操刀上阵，不为别的，只为再吐一次。</p>

<p>用料：鸡胸肉一块，黄瓜一根，甜面酱，葱，料酒，酱油，盐，味精，淀粉，糖，自来水，菜刀，案板，锅，电磁炉，油烟机，自行车。。。</p>

<p>主要步骤如下：
<ol>
	<li>鸡肉化冻，黄瓜大葱洗干净；</li>
	<li>鸡肉切丁，大小以大块熟了小块还没有糊为宜，放碗里加淀粉、盐，抓之；</li>
	<li>黄瓜切丁，大小自便，装盘；</li>
	<li>葱切段，葱的用量大约根据以下公式计算： 葱用量=家里储备葱的总长度/未来可预计的几天內做菜总次数；</li>
	<li>小碗装酱油、料酒、味精、水淀粉、糖搅和成汁备用；</li>
	<li>开火倒油加热冒烟，把1/3葱和鸡丁扔进锅里，炒到洁白的鸡丁如嚼过的口香糖一般出锅；</li>
	<li>锅里留一些油，油少了可以再加一些，待油热，放两勺甜面酱（这里用的是李锦记的沪式甜酱，这个味道比较符合本人年幼时候对甜面酱的最初记忆），把剩下的葱一起扔锅里炒到寂寞为止；</li>
	<li>加黄瓜丁，盐，炒，加鸡丁，炒，加第5步准备的汁，炒；</li>
	<li>等到粘稠之后即可出锅，如果没有粘稠也见好就收吧；</li>
	<li>#</li>
</ol>
有图不一定是真相：
<img class="alignnone" title="-" src="http://pic.yupoo.com/classicning/484888192078/medium.jpg" alt="" width="500" height="336" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/09/19/geohash/">GeoHash</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-19T00:00:00+08:00" pubdate data-updated="true">Sep 19<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今天偶然看到一个Ruby的GeoHash库，功能非常简单，就是将经纬度坐标哈希成字符串，并且，利用这个字符串可以粗略地比较两点的距离。这个库的代码host在GitHub上，要安装，需要将github加入gem：
<em>sudo gem sources -a http://gems.github.com<br />
sudo gem install davotroy-geohash</em></p>

<p>用法，irb：
<em>irb(main):001:0&gt; require &#8216;rubygems&#8217;<br />
=&gt; true<br />
irb(main):002:0&gt; require &#8216;geohash&#8217;<br />
=&gt; true<br />
irb(main):003:0&gt; GeoHash.encode(32.168, 118.54)<br />
=&gt; &#8220;wtsr12n0nj&#8221;<br />
irb(main):004:0&gt; GeoHash.decode(&#8216;wtsr12n0nj&#8217;)<br />
=&gt; [32.168, 118.54]</em></p>

<p>代码可以从github上获得
<em>git clone git://github.com/davetroy/geohash.git</em></p>

<p>GeoHash的核心部分用C实现，仔细看一下可以发现是一个四叉树的结构：
<pre>[codesyntax lang="c"]
#define BASE32	"0123456789bcdefghjkmnpqrstuvwxyz"
static void encode_geohash(double latitude, double longitude, int precision, char *geohash) {
	int is_even=1, i=0;
	double lat[2], lon[2], mid;
	char bits[] = {16,8,4,2,1};
	int bit=0, ch=0;</pre></p>

<p>	lat[0] = -90.0;  lat[1] = 90.0;<br />
	lon[0] = -180.0; lon[1] = 180.0;</p>

<p>	while (i &lt; precision) {<br />
		if (is_even) {<br />
 			mid = (lon[0] + lon[1]) / 2;<br />
 			if (longitude &gt; mid) {<br />
				ch |= bits[bit];<br />
				lon[0] = mid;<br />
			} else<br />
				lon[1] = mid;<br />
		} else {<br />
			mid = (lat[0] + lat[1]) / 2;<br />
			if (latitude &gt; mid) {<br />
				ch |= bits[bit];<br />
				lat[0] = mid;<br />
			} else<br />
				lat[1] = mid;<br />
		}</p>

<p>		is_even = !is_even;<br />
		if (bit &lt; 4)<br />
			bit++;<br />
		else {<br />
			geohash[i++] = BASE32[ch];<br />
			bit = 0;<br />
			ch = 0;<br />
		}<br />
	}<br />
	geohash[i] = 0;<br />
}</p>

<p>[/codesyntax]

可惜在学校的时候没有看到这么精致的代码。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2009/09/13/%E7%83%A7%E9%A5%AD/">烧饭</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-13T00:00:00+08:00" pubdate data-updated="true">Sep 13<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>首先再祝<a href="http://blog.nulltao.net/">标题中的人</a>生日快乐。</p>

<p>虽说daf同学做菜好看好吃（看出奉承意思的读者请可以买棒棒糖奖励自己），但是这不能成为本人自甘堕落自甘刷碗停滞不前的理由。况且，作为一个口味疑似诡异的人，如果不练好技术，掌握一技之长，将来很难在厨房立足，更不要提取得话语权。甚至没有在饭前进厨房的机会，下场会很惨。</p>

<p>以上是关于烧饭必要性的论述。入正题，今天迎着正午的朝阳，从超市买回了青椒芹菜牛肉鸡肉，为了能让才华体现得淋漓尽致，做了两个菜。简述过程的话大抵是以下<a href="http://blog.samsonis.me/tag/update/">update体</a>流程：
<ol>
	<li>洗菜；</li>
	<li>牛肉切丝（个中坎坷不作赘述），加料酒、淀粉、盐；</li>
	<li>鸡肉切片（个中曲折不必了解），加蛋清、盐、淀粉；</li>
	<li>芹菜切段；</li>
	<li>小碗调酱油、醋、糖、料酒，备用；</li>
	<li>葱姜切末备用；</li>
	<li>开火倒油，油热了加葱姜末和辣椒酱（家里没有正经辣椒酱了，就用辣椒豆豉代替，此决定终遗千古恨），牛肉丝下锅，变色，取出；</li>
	<li>炒芹菜；</li>
	<li>牛肉芹菜混合，再炒，把第5步的混合液体倒进锅里，搅搅，加味精装盘；</li>
	<li>洗锅；</li>
	<li>开火倒油，油热了加葱姜末，鸡肉下锅，待变色后变糊前取出；</li>
	<li>青椒撕碎下锅，不时加水，炒到上一步油烟被吸得差不多为止；</li>
	<li>混合，加味精，出锅。</li>
	<li>#</li>
</ol>
留张照片有图有真相：</p>

<p><img title="food" src="http://pic.yupoo.com/classicning/829998100bcc/small.jpg" alt="" width="240" height="161" /></p>

<p>关于照片中出现的“暗物质”，绝对不是因为鸡肉片切得太不均匀导致有的糊了有的还没熟，最后葱姜通通糊掉油烟满厨房的结果。还有为什么只有一张照片呢？原因是另一盘菜拍照构图的时候发现需要的曝光时间比较长，没有带三脚架所以拍不出理想的效果，故而没有把照片发上来。画外音：就是酱油放多了太黑了，画外音毕。画外音：把刚才那个画外音的拖出去砍了，画外音毕。</p>

<p>最后引用一句名人名言，你永远不会知道自己的下一盘菜到底是什么味道。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/blog/page/34/">&larr; Older</a>
    
    <a href="/blog/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/blog/page/32/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/blog/2013/10/22/swapping-harddisk-without-pain/">Archlinux 梧桐更换硬盘</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/10/08/delicious-released/">Delicious 发布</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/07/16/four-years-as-programmer/">工作四周年</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/07/05/grunt-for-requirejs-projects/">Grunt for Requirejs Projects</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/06/29/%E7%BB%99-raspberry-pi-%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%98%BE%E7%A4%BA-ip-%E7%9A%84%E6%B6%B2%E6%99%B6%E5%B1%8F/">给 Raspberry Pi 添加一个显示 IP 的液晶屏</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/sunng87">@sunng87</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'sunng87',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/blog/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/classicing?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/classicing">My Delicious Bookmarks &raquo;</a></p>
</section>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Sun Ning -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'sunng-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
