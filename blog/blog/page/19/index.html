
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Here comes the Sun</title>
  <meta name="author" content="Sun Ning">

  
  <meta name="description" content="契机。
早就想买个类似技术的电子书，年初的时候就有过这样的打算，几乎到了只欠东风的节骨眼上，还是畏惧了2000多的高价。事实证明等待是正确的，半年之后，盛大的Bambook发布了，Kindle3的价格也出来了，从此6寸的电子书都降到了1000人民币以下。情绪逐渐接近临界， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sunng87.github.io/blog//blog/page/19">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/blog/atom.xml" rel="alternate" title="Here comes the Sun" type="application/atom+xml">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Here comes the Sun</a></h1>
  
    <h2>Sun Ning's web log</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:sunng87.github.io/blog/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/10/16/kindle%E5%B7%B2%E8%BF%87%E4%B8%87%E9%87%8D%E5%B1%B1/">Kindle已过万重山</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-16T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><h3>契机。</h3>
早就想买个类似技术的电子书，年初的时候就有过这样的打算，几乎到了只欠东风的节骨眼上，还是畏惧了2000多的高价。事实证明等待是正确的，半年之后，盛大的<a href="http://bambook.sdo.com">Bambook</a>发布了，Kindle3的价格也出来了，从此6寸的电子书都降到了1000人民币以下。情绪逐渐接近临界，开始和samson讨论购买的计划，熟人代购or淘宝代购。不料看到goodtiger率先出手，积聚的能量瞬间爆发。不到24的小时之后，kindle三人组成立了。。。</p>

<p><h3>动机。</h3>
作为城市的低收入群体，我们有责任有义务把钱花到刀刃上。很多人说为神马不买ipad呢，功能强大得多。实际上，我的需求仅限于消费我~/Docuemnt/EBook/目录下永无止尽的文档。在电脑屏幕上，从Adobe Reader，到Simply a reader的<a href="http://projects.gnome.org/evince/">Evince</a>，到more than a reader的<a href="http://okular.kde.org/">Okular</a>，到apvlv，到zathura，即使支持了inverted colors这样的功能，终归还是不能满足舒适看书的需求。OK，只有看书这么简单，甚至你还要防止设备上多余的功能让你在看书的时候分神，你还有其他选择吗？</p>

<p><h3>渠道。</h3>
什么样的渠道让能量毫无顾虑的突破临界呢，当然是<a href="http://pipitu.org/2010/03/10/nexus-one-%E9%A3%98%E6%B4%8B%E8%BF%87%E6%B5%B7%E5%85%A5%E6%89%8B%E8%AE%B0/">有人吃过螃蟹的渠道了</a>。这是一个中继服务，他们为你生成一个美国的地址，你只需要用这个地址在Amazon网站上注册购买，货物会寄到该地址然后转寄到国内你的真实地址。9月7号，我在Amazon网站上pre-order了Kindle3，到了9月17号，Amazon发货；9月20号，包裹到达中继服务的美国地址；支付了国际邮递费用的，9月22号包裹发货，9月23号包裹离开美国。</p>

<p>接下来悲剧就开始了，漫长的纠结的杳无音信，直到9月28号下午，突然收到一个陌生号码发来的短信：您的包裹需要交税！最终还是倒在了之前说的大boss手下。因为短信实在可疑，花了一天核实，到了9月30号下午终于把关税费用打给了对方。接着是漫长的十一假期，继续杳无音信。到了10月8号，终于上班了！打电话到这家公司，结果对方的电话居然坏掉，一接通就是杂音，根本没有办法对话。我心一凉，这回是不是要悲凉了。</p>

<p><h3>实物</h3>
好在这回没有背到那种程度，10月11号毫无征兆地接到快递的电话，我想这事成了！</p>

<p>拿到Kindle，开封。一张简易说明书、一个机器，一根数据线。
<a href="http://www.flickr.com/photos/40741608@N08/5085519950/" title="DSC_0003 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4091/5085519950_f23acc21f5.jpg" width="500" height="335" alt="DSC_0003" /></a></p>

<p>屏幕效果：
<a href="http://www.flickr.com/photos/40741608@N08/5085548956/" title="DSC_0004 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4092/5085548956_47cdaaefeb.jpg" width="335" height="500" alt="DSC_0004" /></a></p>

<p>对pdf格式，kindle3虽然原生支持，但是由于pdf本身格式的限制，只能支持到区域缩放，而不支持字体缩放。6寸的屏幕阅读还是有难度的。好在，Amazon提供了格式转换服务，您可以参考<a href="http://blog.samsonis.me/2010/09/update-42-before-kindle-arrives%E2%80%A6/">samson的预习作业</a>把pdf转换成kindle格式。</p>

<p>当然，kindle3内置一个浏览器，如果你能够忍受黑白屏幕和它的屏幕刷新速度，可以尝试一下。
<a href="http://www.flickr.com/photos/40741608@N08/5085043781/" title="DSC_0005 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4111/5085043781_215ca3fa12.jpg" width="500" height="335" alt="DSC_0005" /></a>
UA显示是Linux操作系统，Webkit核心。</p>

<p><h3>费用</h3>
最后透露一下费用。Kindle3 Wifi的价格是$139，Amazon美国邮递免运费。中继服务国际邮递的费用是$21.79，海关关税190元人民币。最近汇率动荡得厉害，今天的汇率已经是1:6.6405了。总价是<br />
echo &#8220;(139+21.79)*6.6405+190&#8221; | bc<br />
1257.7259</p>

<p>今天看到淘宝上已经有1150的价格了，应该是少了关税。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/10/11/a-fine-day/">A Fine Day</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-11T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>好久没有聊生活了，最近心绪比较杂乱，虽说不像以前那么忙，不过也没像以前那样有时间来贫一下。好在今天倒是这么多年难得的一个顺风日，一切顺利。</p>

<p>上周体检今天出了结果，全部PASS。虽然有一点点心动过速，不过没有大碍。我一直担心的谷丙转氨酶这次终于没有出乱子。其实这半年加班加上压力比较大，有的时候能明显感觉到胸闷，体检之前心里还真没底。不过好在是还年轻，还能顶一顶。尽管是有紧张的因素，但是心动过速也算是个预警吧，以后要加强锻炼。这话不知道说了多少遍了。</p>

<p>另一件事，Kindle终于毫无征兆的到了。9月6号我们kindle三人组（<a href="http://blog.samsonis.me">1</a>，<a href="http://blog.goodtiger.net/">2</a>）通过comgateway订了kindle3，到了9月17号Amazon发货，9月23号从comgateway发货。之后就杳无音信，从comgateway上的跟踪系统看根本就是绝望。结果到了9月28号正在跟samson闲聊的时候，突然收到一条莫名奇妙的短信，说您的货物已经到了北京库到家，要交税，真是又喜又悲。这还没完，花了一天confirm短信的真实性，直到30号中午才把税款打出去。接着就是无尽的国庆假期，漫漫7天过后，迫不及待打电话到库到家，结果8号一天占线，9号好不容易接通了，对方电话却坏了全是杂音跟不听不见说话。说实在的要不是有pipitu先前购物的经验，我这时候就觉得被骗了。好在，好在，今天上午顺丰快递总算是把东西送来了！</p>

<p>有关kindle的细节，过两天再和大家慢慢唠。</p>

<p>今天正好还是妈妈的生日，晚上我们找了一家山西饭馆饱餐一顿，感觉好极了！</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/10/08/the-4k-story/">The 4k Story</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-08T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>从 Redis 2.0 开始，Redis的作者就不断地被问道，你为什么要自己造一个VM轮子呢。尽管作者在<a href="http://code.google.com/p/redis/wiki/FAQ#Do_you_plan_to_implement_Virtual_Memory_in_Redis?_Why_don%27t">FAQ</a>里说明了，但是仍然有很多不同意见。</p>

<p>反向代理Varnish的开发人员，Poul-Henning Kamp 写了一篇文章，<a href="http://www.varnish-cache.org/trac/wiki/ArchitectNotes">What&#8217;s wrong with 1975 programming ?</a>，锋芒毕露，矛头直指竞争对手Squid，顺便也打击一大片牵连到了Redis的作者Antirez。他说：
<blockquote>I have spent many years working on the FreeBSD kernel, and only rarely did I venture into userland programming, but when I had occation to do so, I invariably found that people programmed like it was still 1975. </blockquote>
Kamp兄有来到user-space之后一夜回到解放前的感觉，又好像摇晃着饮料瓶子对着Antirez说：你Out啦！也许是因为作者就是个内核开发者，所以Varnish对操作系统的Virtual Memory机制充分信任，把Squid对内存的手动管理称为wasted work。&#8221;So Welcome to Varnish, a 2006 architecture program. &#8221;</p>

<p>还有<a href="http://blog.kennejima.com/post/1226487020/thoughts-on-redis">用户</a>也提出
<blockquote>
Redis doesn’t use OS swap. According to Salvatore Sanfilippo, the creator of Redis, it was because the page size of 4KB was too big. I personally don’t think that helps but it’d be better if Redis preallocated specified amount of buffer pool and bring related objects to the same page to increase locality of reference, instead of letting the heap manager blindly fragment objects. In my opinion, the page size of 32 bytes is too small, considering that the hardware architectures and the compilers are optimized for the conventional page size. In that scale, even the latency of reading something from RAM could be dominant (RAM is too slow for CPU, therefore it’s got L1/L2 cache), and RAM has the pipelined burst mode to pre-fetche memory contents at a few clock cycles, before they are actually requested.
</blockquote></p>

<p>5号，Antirez在博客上写了回击 <a href="http://antirez.com/post/what-is-wrong-with-2006-programming.html">What&#8217;s wrong with 2006 programming?</a>，他认为：
<ul>
<li>OS Swap在一些情况下会导致客户端阻塞</li>
<li>4K大小的Page可能包含很多key，其中总有一些被访问到，导致操作系统无法swap这些page</li>
<li>使用自己实现的Paging为程序提供了极大的自由度，包括作者提到的2.2将会引入的数据压缩、新的数据结构以及自定义的过期算法</li>
</ul></p>

<p>前段时间，Foursquare用MongoDB时，因为Sharding方法一些疏漏把大量的数据集中到了一台机器上，导致一台EC2实例内存耗尽无法工作。Mongodb的内部机制就是mmap，我的同事做过相关的测试，当内存耗尽时，读写操作都使用磁盘，这时mongodb的性能是完全无法使用的。事后10gen的开发人员Horowitz总结出现问题的原因<a href="http://groups.google.com/group/mongodb-user/browse_thread/thread/528a94f287e9d77e">总结出现问题的原因</a>时，其中很重要的一点是
<blockquote>Document size is less than 4k. Such documents, when moved, may be too small to free up pages and, thus, memory. </blockquote></p>

<p>看了这个原因，Redis的作者Twitter上大喜：&#8221;Real world instance of my 4k page + small objects concerns&#8221;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/10/07/douban-on-gwibber-2/">Douban on Gwibber #2</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-07T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.flickr.com/photos/40741608@N08/5058425003/" title="Gwibber douban by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4145/5058425003_6bd9c4b6e7.jpg" width="397" height="500" alt="Gwibber douban" /></a></p>

<p>Douban support on gwibber, tested on Gwibber <strong>2.32.0-ubuntu2</strong> or <strong>2.32.0.1-ubuntu1</strong> , Ubuntu Maverick.</p>

<p>You can download it from bitbucket:
<a href="http://bitbucket.org/sunng/gwibber-douban/downloads">http://bitbucket.org/sunng/gwibber-douban/downloads</a></p>

<p>Installation:<br />
Unpack and run install script with super user privilege:
<i>sudo bin/install.sh</i></p>

<p>We will create backup for you. To rollback, just run <i>sudo bin/uninstall.sh</i> .</p>

<p>Any feedback is welcome.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/10/06/rhythmbox-plugin-for-douban-fm/">Rhythmbox Plugin for Douban FM</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-06T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://code.google.com/p/dbfmplugin/">Rhythmbox 豆瓣电台插件</a>是由cdredfox基于<a href="http://github.com/sunng87/exaile-doubanfm-plugin/blob/master/libdoubanfm.py">libdoubanfm</a>开发的另一个Linux桌面豆瓣电台客户端。如果您是Rhythmbox的忠实用户，现在您有一个新的选择了。</p>

<p><image src="http://hnyangfei.appspot.com/media/aglobnlhbmdmZWlyDQsSBU1lZGlhGImbBAw/%E8%96%9B%E5%87%AF%E7%90%AA%20-%20%E5%A4%8D%E5%88%BB%E5%9B%9E%E5%BF%86_007.png" width="500" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/10/05/douban-on-gwibber/">Douban on Gwibber</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-05T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Now it&#8217;s possible to use Gwibber as a desktop Douban.</p>

<p>Setup a douban client in the account dialog:
<a href="http://www.flickr.com/photos/40741608@N08/5053311735/" title="GwibberDoubanSetup by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4130/5053311735_5fc69747a5.jpg" width="500" height="259" alt="GwibberDoubanSetup" /></a></p>

<p>Authorize Gwibber to access private data on Douban (OAuth):
<a href="http://www.flickr.com/photos/40741608@N08/5053311377/" title="DoubanOAuthAuthorize by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4147/5053311377_43b0a4788e.jpg" width="500" height="394" alt="DoubanOAuthAuthorize" /></a></p>

<p>Display Douban activities on Gwibber timeline:
<a href="http://www.flickr.com/photos/40741608@N08/5053311635/" title="GwibberDouban by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4103/5053311635_ab6716100b.jpg" width="422" height="500" alt="GwibberDouban" /></a></p>

<p>The code has been uploaded to bitbucket:
<a href="https://bitbucket.org/sunng/gwibber-douban/overview">https://bitbucket.org/sunng/gwibber-douban/overview</a></p>

<p>I am currently working on an installation script.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/10/01/redis-data-struct/">Redis Data Struct</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-10-01T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://redis.io">Redis</a>的几个核心数据结构定义在redis.h和dict.h中。Redis服务器总的数据结构里的根节点是redisServer，下面包含一个redisDb结构数组。数组的大小定义在redis.conf中的databases项，客户端可以通过select命令选择相应的DB。</p>

<p>一个redisDb定义了redis数据库的基本数据结构，redisDb结构定义如下<br />
[cc lang=&#8221;c&#8221;]<br />
typedef struct redisDb {<br />
    dict *dict;                 /* The keyspace for this DB */<br />
    dict *expires;              /* Timeout of keys with a timeout set */<br />
    dict *blocking_keys;        /* Keys with clients waiting for data (BLPOP) */<br />
    dict *io_keys;              /* Keys with clients waiting for VM I/O */<br />
    dict *watched_keys;         /* WATCHED keys for MULTI/EXEC CAS */<br />
    int id;<br />
} redisDb;<br />
[/cc]</p>

<p>其中
<ul>
<li>dict 用于存储键值的哈希表结构</li>
<li>expires 用于存储键、过期时间的哈希表结构</li>
<li>blocking_keys 用于存储键、阻塞数据的哈希表结构。目前仅仅在阻塞式的blpop brpop中使用。</li>
<li>io_keys 存储等待将数据从swap读出的key （vmThreadedIOCompletedJob, dontWaitForSwappedKey, waitForSwappedKey）</li>
<li>watched_keys 用于支持<a href="http://code.google.com/p/redis/wiki/MultiExecCommand#Check_and_Set_%28CAS%29_transactions_using_WATCH">WATCH</a>命令，实现乐观锁功能</li>
<li>id 数据库编号</li>
</ul></p>

<p>dict结构定义在dict.h中，主要的定义有：<br />
[cc lang=&#8221;c&#8221;]<br />
typedef struct dictEntry {<br />
    void *key;<br />
    void *val;<br />
    struct dictEntry *next;<br />
} dictEntry;</p>

<p>typedef struct dictht {<br />
    dictEntry **table;<br />
    unsigned long size;<br />
    unsigned long sizemask;<br />
    unsigned long used;<br />
} dictht;</p>

<p>typedef struct dict {<br />
    dictType *type;<br />
    void *privdata;<br />
    dictht ht[2];<br />
    int rehashidx; /* rehashing not in progress if rehashidx == -1 */<br />
    int iterators; /* number of iterators currently running */<br />
} dict;</p>

<p>[/cc]</p>

<p>每个dict中包含两个dictht结构，用来在rehash的时候进行数据交换。rehashidx用于记录rehash的进程，值是当前rehash的table索引。dictht中table二维数组，以hash值为索引。size是哈希表的大小，初始值是4，随着rehash的进行，变成大于size的最小2<sup>n</sup>。sizemask是size-1，用来与哈希值做&运算。</p>

<p>redis在引如virtual memory之前，就是以这样的数据结构运行在内存中的。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/09/24/visualize-call-tree-of-a-c-function/">Visualize Call Tree of a C Function</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-24T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><h3>Requirement</h3>
You want to visualize a call hierarchy of a C function.</p>

<p><h3>Solution</h3>
Utilities you need are listed below:
<ul>
<li><a href="http://www.gnu.org/software/cflow/">GNU cflow</a></li>
<li><a href="http://cflow2vcg.sourceforge.net/">cflow2vcg</a></li>
<li>graphviz</li>
</ul></p>

<p>Take &#8216;rdbSaveBackground&#8217; (<a href="http://github.com/antirez/redis/blob/master/src/rdb.c">redis/rdb.c</a>) for example:<br />
[cc lang=&#8221;bash&#8221;]<br />
cflow &#8211;format=posix &#8211;omit-arguments &#8211;level-indent=&#8217;0=\t&#8217; &#8211;level-indent=&#8217;1=\t&#8217; &#8211;level-indent=start=&#8217;\t&#8217; -m &#8216;rdbSaveBackground&#8217; ~/osprojects/redis/src/rdb.c | cflow2dot | dot -Tjpg -o rdb.jpg<br />
[/cc]</p>

<p>Output:
<a href="http://www.flickr.com/photos/40741608@N08/5020142591/" title="visualization of a call tree by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4111/5020142591_7b34a52e3c.jpg" width="500" height="98" alt="visualization of a call tree" /></a></p>

<p>Source: <a href="http://unixdiary.blogspot.com/2006/05/using-cflow.html">unix diary</a></p>

<p>The post is brought to you by <a href="http://fedorahosted.org/lekhonee">lekhonee</a> v0.7</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/09/22/lua-script-for-geany-to-view-manpage-of-functions/">Lua Script for Geany to View Manpage of Functions</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-22T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><h3>Requirement</h3>
When editing when Geany, you need some document of system library functions at hand. So you want to browse manpage at any time.</p>

<p><h3>Solution</h3>
Just two lines:<br />
[cc lang=&#8221;lua&#8221;]<br />
sel=geany.selection()<br />
geany.launch(&#8216;rxvt-unicode&#8217;, &#8216;-e&#8217;, &#8216;man&#8217;, sel)<br />
[/cc]
<a href="http://gist.github.com/591279">http://gist.github.com/591279</a></p>

<p><h3>Install</h3>
Make sure you have geany-plugin-lua installed:
<i>sudo apt-get install geany-plugin-lua</i></p>

<p>Create a lua source file named &#8216;ShowMan.lua&#8217; in <i>~/.config/geany/plugins/geanylua/</i>  . If the direcotry does not exist, you should create it first.</p>

<p>Copy two lines of lua code into this file, save and close.</p>

<p>Create a file named hotkeys.cfg in <i>~/.config/geany/plugins/geanylua/</i>, add following content:
<i>ShowMan.lua</i></p>

<p>Restart geany, then open Preferences->Keybindings, Lua Script-> ShowMan, bind a key, for example, Alt+m</p>

<p><h3>Usage</h3>
Select the function name, and press Alt+m (or from menu Tools->Lua Scripts->ShowMan), then you see the terminal and the manpage.</p>

<p><a href="http://www.flickr.com/photos/40741608@N08/5017060556/" title="geany-lua-manpage by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4127/5017060556_ca89e90517.jpg" width="500" height="313" alt="geany-lua-manpage" /></a></p>

<p>The post is brought to you by <a href="http://fedorahosted.org/lekhonee">lekhonee</a> v0.7</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/09/18/gui-debugging-tools/">GUI Debugging Tools</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-09-18T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>想了解一个C程序的运行，打算用gdb来单步看一下流程，发现直接用gdb不太方便，然后模仿偶像用emacs的gdb支持(M-x gdb)。但是境界实在是比不上偶像，emacs的操作都还不熟练。最后选择了geany。<a href="http://www.geany.org">geany</a>是一个简单的C/C++ IDE，它有一个geanygdb插件可以帮助你在geany的图形界面里调试。</p>

<p>但是最近安装在仓库里的geanygdb插件有一些问题，会导致很高的CPU占用。不过这个问题被报告在<a href="http://sourceforge.net/tracker/?func=detail&amp;aid=3019827&amp;group_id=222729&amp;atid=1056532">这里</a>，现在已经修复了。因为新版本还没有release，所以如果急着用的话，可以从svn签出代码：
<i>svn co https://geany-plugins.svn.sourceforge.net/svnroot/geany-plugins/trunk/geany-plugins</i>
然后执行：<br />
[cc lang=&#8221;bash&#8221;]<br />
cd geany-plugins<br />
./autogen.sh<br />
./configure<br />
cd geanygdb<br />
make<br />
sudo make install<br />
[/cc]</p>

<p>重启geany，打开plugin manager，看到geanygdb的版本已经变成0.20就可以使用了。</p>

<p>geany现在还不支持ctags，是因为它内部有一套自己的tags实现。代码导航可以用过上下文菜单 Go to tag Definition 或者 Go to tag Declaration 实现，最好是到Preference中给这两个命令设置一个快捷键，比如Ctrl+]，再对Navigate back 设置一个Ctrl+t，就如同vim+ctags一样了。</p>

<p>实际上在GNOME桌面还有一个专门的GDB图形界面，叫做<a href="http://projects.gnome.org/nemiver/">Nemiver</a>。Nemiver对gdb的常用命令都有快捷键操作，把鼠标移动到代码上还可以查看变量的值，效果和eclipse调试java程序一样，非常强大。</p>

<p>The post is brought to you by <a href="http://fedorahosted.org/lekhonee">lekhonee</a> v0.7</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/blog/page/20/">&larr; Older</a>
    
    <a href="/blog/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/blog/page/18/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>Programmer. Map enthusiast. (<a href="http://sunng.info/">more</a>)</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/blog/2014/04/20/concurrent-pipeline-with-core-async/">Papaline: Concurrent Pipeline With core.async</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/04/20/rust-concurrent-made-safely/">Rust语言：安全的并发</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/03/04/slacker-0-dot-11-released/">Slacker Library Updated</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/10/22/swapping-harddisk-without-pain/">Archlinux 安全更换硬盘</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/10/08/delicious-released/">Delicious 发布</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/sunng87">@sunng87</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'sunng87',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/blog/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/classicing?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/classicing">My Delicious Bookmarks &raquo;</a></p>
</section>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Sun Ning -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'sunng-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
