
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>车水马龙</title>
  <meta name="author" content="Sun Ning">

  
  <meta name="description" content="Ubuntu仓库里有个weather-util包，可以用来查看天气信息。weather工具从weather.noaa.gov网站获得天气信息，对美国的城市可以直接用名字查询，其他国家只能使用id查询。id的规则和weather.com不太相同。 中国的天气站点id可以在这个页面上查到。 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sunng87.github.io/blog//blog/page/26">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/blog/atom.xml" rel="alternate" title="车水马龙" type="application/atom+xml">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">车水马龙</a></h1>
  
    <h2>here comes the sun</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:sunng87.github.io/blog/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/18/using-weather/">Using Weather</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-18T00:00:00+08:00" pubdate data-updated="true">Feb 18<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ubuntu仓库里有个weather-util包，可以用来查看天气信息。weather工具从weather.noaa.gov网站获得天气信息，对美国的城市可以直接用名字查询，其他国家只能使用id查询。id的规则和weather.com不太相同。</p>

<p>中国的天气站点id可以在<a href="http://weather.noaa.gov/weather/CN_cc.html">这个页面</a>上查到。比如南京ZSNJ，上海浦东ZSPD。使用weather工具查询：
<em>weather -i ZSNJ</em>
<blockquote>Current conditions at China (ZSNJ) 32-00N 118-48E 12M (ZSNJ)<br />
Last updated Feb 18, 2010 - 08:00 AM EST / 2010.02.18 1300 UTC<br />
   Temperature: 35 F (2 C)<br />
   Relative Humidity: 59%<br />
   Wind: from the SSW (210 degrees) at 4 MPH (4 KT)</blockquote></p>

<p>简化操作，可以在$HOME下创建.weatherrc文件，形如<br />
[cc lang=&#8221;ini&#8221;]<br />
[default]<br />
ID = ZSPD<br />
[nj]<br />
ID = ZSNJ<br />
[/cc]</p>

<p>就可以直接使用
<em>weather</em>
<blockquote>
Current conditions at China (ZSPD) 31-07N 121-46E (ZSPD)<br />
Last updated Feb 18, 2010 - 08:00 AM EST / 2010.02.18 1300 UTC<br />
   Temperature: 35 F (2 C)<br />
   Relative Humidity: 47%<br />
   Wind: from the NE (050 degrees) at 7 MPH (6 KT) (direction variable)
</blockquote>
和
<em>weather nj</em>
<blockquote>Current conditions at China (ZSNJ) 32-00N 118-48E 12M (ZSNJ)<br />
Last updated Feb 18, 2010 - 08:00 AM EST / 2010.02.18 1300 UTC<br />
   Temperature: 35 F (2 C)<br />
   Relative Humidity: 59%<br />
   Wind: from the SSW (210 degrees) at 4 MPH (4 KT)</blockquote></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/14/%E8%80%81%E7%89%A9%E4%BB%80-old-stuff/">老物什 / Old Stuff</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-14T00:00:00+08:00" pubdate data-updated="true">Feb 14<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>大年初一翻旧物，找到一些让人颇有感触的旧物件。2004年买的RH9，2005年夏天买的Fedora 4。前者至今还安装在我家最旧的电脑里，虽然我都忘了它的样子了。</p>

<p>包装
<a href="http://www.flickr.com/photos/40741608@N08/4355891380/" title="00011 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4044/4355891380_b32fe9d173.jpg" width="500" height="335" alt="00011" /></a>
<a href="http://www.flickr.com/photos/40741608@N08/4355892466/" title="00012 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4008/4355892466_04bca6512d.jpg" width="500" height="335" alt="00012" /></a>
<a href="http://www.flickr.com/photos/40741608@N08/4355894700/" title="00014 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4061/4355894700_a83995eaca.jpg" width="500" height="335" alt="00014" /></a>
<a href="http://www.flickr.com/photos/40741608@N08/4355150633/" title="00013 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4049/4355150633_106e97e909.jpg" width="500" height="335" alt="00013" /></a>
<a href="http://www.flickr.com/photos/40741608@N08/4355155529/" title="00018 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4057/4355155529_d0397b83d3.jpg" width="500" height="335" alt="00018" /></a></p>

<p>手册
<a href="http://www.flickr.com/photos/40741608@N08/4355153647/" title="00016 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4010/4355153647_7877938213.jpg" width="500" height="335" alt="00016" /></a>
<a href="http://www.flickr.com/photos/40741608@N08/4355171643/" title="00022 by 贝小塔, on Flickr"><img src="http://farm3.static.flickr.com/2708/4355171643_d7c67e9d3a.jpg" width="500" height="335" alt="00022" /></a>
<a href="http://www.flickr.com/photos/40741608@N08/4355170579/" title="00021 by 贝小塔, on Flickr"><img src="http://farm3.static.flickr.com/2744/4355170579_18ee80953a.jpg" width="500" height="335" alt="00021" /></a></p>

<p>CDs
<a href="http://www.flickr.com/photos/40741608@N08/4355152825/" title="00015 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4042/4355152825_d7b6d44328.jpg" width="500" height="335" alt="00015" /></a>
<a href="http://www.flickr.com/photos/40741608@N08/4355897540/" title="00017 by 贝小塔, on Flickr"><img src="http://farm3.static.flickr.com/2802/4355897540_6ff0e17b46.jpg" width="500" height="335" alt="00017" /></a>
<a href="http://www.flickr.com/photos/40741608@N08/4355899486/" title="00019 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4064/4355899486_a9a618f68f.jpg" width="500" height="335" alt="00019" /></a>
<a href="http://www.flickr.com/photos/40741608@N08/4355900468/" title="00020 by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4004/4355900468_ec4c180d79.jpg" width="500" height="335" alt="00020" /></a></p>

<p>这个代理商里仁软件似乎已经倒闭了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/14/i-%E2%99%A5-free-and-open-source-software/">I ♥ Free and Open Source Software</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-14T00:00:00+08:00" pubdate data-updated="true">Feb 14<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://fsfe.org/campaigns/valentine-2010/valentine-2010.html"><img src="http://fsfe.org/campaigns/valentine-2010/vd-i-love-fs-358x60.png" style="border: 0 !important;" alt="I love Free Software!" /></a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/12/virtual-machine-searcher-for-gnome-deskbar-applet/">Virtual Machine Searcher for Gnome Deskbar Applet</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-12T00:00:00+08:00" pubdate data-updated="true">Feb 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Very glad to announce another daily-coding work: an extension for gnome deskbar applet to search and launch virtual machine. There is a plugin for gnome-do that does the same job. That&#8217;s what I create the the plugin for. I switched to deskbar because gnome-do&#8217;s Do.exe reminds me nightmares when I was a M$ Windows user. The deskbar applet has been a great replacement, however, the virtualbox plugin in Do is really impressive while deskbar doesn&#8217;t provide me the same functionality.</p>

<p>You can ignore words above and just take a look at the screenshot:
<a title="deskbar-virtualbox by 贝小塔, on Flickr" href="http://www.flickr.com/photos/40741608@N08/4350951202/"><img src="http://farm5.static.flickr.com/4062/4350951202_9ede9c4318_o.png" alt="deskbar-virtualbox" width="560" height="400" /></a>
<h3>Download</h3>
Download the extension from (the highlighted one):
<a href="http://bitbucket.org/sunng/daily-coding/downloads/?highlight=8792">http://bitbucket.org/sunng/daily-coding/downloads/?highlight=5137</a></p>

<p>You can also trace the development at bitbucket project. However, the repository is mixed with other small code snippets. Currently, mercurial doesn&#8217;t support subdirectory pull. So there is no way to grab the deskbar-applet individually.
<h3>Installation</h3>
copy this file to <em>/usr/lib/deskbar-applet/deskbar-applet/modules-2.20-compatible/</em> (Ubuntu installation for example) with super user privilege. Right click desktbar applet, select Preference, Searchers tab, hit &#8220;Reload&#8221; button, then check the Virtualbox Deskbar Module.
<a title="deskbar-preference by 贝小塔, on Flickr" href="http://www.flickr.com/photos/40741608@N08/4350219097/"><img src="http://farm5.static.flickr.com/4006/4350219097_126cdb3c8d.jpg" alt="deskbar-preference" width="500" height="346" /></a>
<h3>Issue</h3>
Feel free the report issues on bitbucket:
<a href="http://bitbucket.org/sunng/daily-coding/issues/">http://bitbucket.org/sunng/daily-coding/issues/</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/12/list-your-installed-virtualbox-virtual-marchines-using-vbox-python-xpcom-api/">List Your Installed Virtualbox Virtual Marchines Using Vbox Python Xpcom Api</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-12T00:00:00+08:00" pubdate data-updated="true">Feb 12<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;m sorry for the long title. Due to lack of documentation, it&#8217;s not easy to use python xpcom api from virtualbox sdk. The code below is just a sample that lists your installed virtual machines. It works on linux with VirtualBox OSE 2.0.8. Hope useful to you.<br />
[cc lang=&#8221;python&#8221;]<br />
import vboxapi<br />
vmsg = vboxapi.VirtualBoxManager(None, None)<br />
vbox = vmsg.vbox<br />
vmsg.mgr.getSessionObject(vbox)<br />
machs = vbox.getMachines()<br />
names = map(lambda x: (x.name,x.id), machs)<br />
print names<br />
[/cc]<br />
Output:<br />
[cc lang=&#8221;python&#8221; nowrap=&#8221;false&#8221; line_numbers=&#8221;false&#8221;]<br />
[(u&#8217;Ubuntu&#8217;, u&#8217;aac3fd46-4f1e-4f6e-8abe-b1a5516abf8c&#8217;), (u&#8217;Windows&#8217;, u&#8217;fa73952e-f0a6-4bf0-af20-259513d73bc1&#8217;), (u&#8217;OpenSolaris&#8217;, u&#8217;a951542c-3178-4a6b-8087-f1b0314e283a&#8217;), (u&#8217;LinuxMint&#8217;, u&#8217;8191f256-1b76-4ce7-a202-93730dae1b33&#8217;), (u&#8217;Fedora&#8217;, u&#8217;ca250f45-d752-4baf-9281-fb0847dc8287&#8217;), (u&#8217;Freebsd&#8217;, u&#8217;8322b62a-aed5-4f04-9815-9fadfeba9fe1&#8217;), (u&#8217;ArchLinux&#8217;, u&#8217;efc1167a-4e06-4c14-aeb0-bfb303c8f5f7&#8217;), (u&#8217;openSUSE&#8217;, u&#8217;02e18816-311d-420b-99b3-6b4b4cccf7b7&#8217;), (u&#8217;CentOS&#8217;, u&#8217;ccf0421c-85c4-4123-8722-57abc494c633&#8217;)]<br />
[/cc]</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/11/%E8%A7%A3%E5%86%B3ubuntu-openbox%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E7%9A%84%E9%97%AE%E9%A2%98/">解决Ubuntu Openbox无法启动的问题</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-11T00:00:00+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今天在工作用的ArchLinux上安装了用Openbox取代了GNOME桌面，感觉良好，回来尝试一下在Ubuntu上也做同样的事情。不料遇到问题，在完成基本的配置之后，Openbox Session无法启动，总是自动跳回gdm。查看.xsession-errors，是gnome-setting-daemon报错：</p>

<p><em>(gnome-settings-daemon:2519): GLib-CRITICAL **: g_propagate_error: assertion `src != NULL&#8217; failed</em></p>

<p>既然是gnome-settings-daemon报错，就在.config/openbox/autostart.sh中注视掉和gnome-settings<em>-</em>daemon相关的部分：
<pre class="brush:bash"># Make GTK apps look and behave how they were set up in the gnome config tools
#if test -x /usr/libexec/gnome-settings-daemon &gt;/dev/null; then
#  /usr/libexec/gnome-settings-daemon &amp;
#elif which gnome-settings-daemon &gt;/dev/null; then
#  gnome-settings-daemon &amp;
# Make GTK apps look and behave how they were set up in the XFCE config tools
#elif which xfce-mcs-manager &gt;/dev/null; then
#  xfce-mcs-manager n &amp;
#fi
</pre>
进而可以启动Openbox Session了，但是发现Conky仍然无法启动，经过搜索是sleep的时间不够长导致的。而根据launchpad上上的讨论，gnome-settings-daemon也可以在Openbox Session启动后正常运行，于是可以这样设置autostart.sh
<pre class="brush:bash">(sleep 20 &amp;&amp; conky 1&gt;/dev/null 2&gt;/dev/null) &amp;
(sleep 2 &amp;&amp; tint) &amp;
(sleep 5 &amp;&amp; tilda) &amp;
(sleep 20 &amp;&amp; gnome-settings-daemon 1&gt;/dev/null 2&gt;/dev/null) &amp;
</pre>
tint和tilda对启动顺序没有明确的要求，conky和gnome-settings-daemon需要设置一个较长的等待时间。</p>

<p>这是Ubuntu中Openbox的一个bug，可以在此跟踪：<br />
https://bugs.launchpad.net/ubuntu/+source/openbox/+bug/459005</p>

<p>顺手展示一下我的Openbox桌面
<a href="http://www.flickr.com/photos/40741608@N08/4346625590/" title="myopenbox by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4067/4346625590_2230b8b3d8.jpg" width="500" height="313" alt="myopenbox" /></a></p>

<p>openbox / tint2 / conky / tilda 还没来得及认真配置，呵呵。</p>

<p>再有，Ubuntu源里的的tint2版本很低，问题不少，不支持宽度的百分数配置，不支持systray等配置。建议安装开发版本：<br />
http://code.google.com/p/tint2/wiki/Install#For_Ubuntu_9.10_%28Karmic%29</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/11/sunngs-canvas-based-heatmap-api/">Sunng&#8217;s Canvas Based Heatmap API</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-11T00:00:00+08:00" pubdate data-updated="true">Feb 11<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Glad to announce my works this morning: A simple heatmap API based on HTML5 canvas.
<a href="http://www.flickr.com/photos/40741608@N08/4347604245/" title="canvas by 贝小塔, on Flickr"><img src="http://farm5.static.flickr.com/4071/4347604245_486bd3a12e_o.jpg" width="300" height="215" alt="canvas" /></a></p>

<p>The programming interface is rather simple now. To create such a heatmap, you just new a heatmap object by:
<pre class="brush:html">
&lt;canvas width="300" height="215" id="canv"&gt;&lt;/canvas&gt;
</pre>
<pre class="brush:javascript">
heatmap = new HeatMap("canv");
</pre></p>

<p>Then read your dataset and push data into the heatmap:
<pre class="brush:javascript">
heatmap.push(x, y, value);
</pre></p>

<p>At last, spread the data and get the canvas rendered:
<pre class="brush:javascript">
heatmap.spread();
heatmap.render();
</pre>
Now you got it.</p>

<p>For advanced usage, you can specify the resolution of heatmap by px:
<pre class="brush:javascript">
heatmap = new HeatMap("canv", 2);
</pre>
Large value will gain performance with low image quality.</p>

<p>Also, you can specify a value to define the attenuation value of each px.
<pre class="brush:javascript">
heatmap.spread(5);
</pre></p>

<p>Finally, there is an option to use your own color schema for heatmap generation.
<pre class="brush:javascript">
heatmap.render(function(value, maxValue){
    var light = value / maxValue * 100;
    return "hsl(20, 75%, "+light+"%)";
});
</pre>
The parameters passed in are current pixel value and max value in whole context.</p>

<p>That&#8217;s all the toolkit. More functionality and options might be added in future. Grab it from my bitbucket page:
<a href="http://bitbucket.org/sunng/daily-coding/src/tip/canvas-heatmap/">http://bitbucket.org/sunng/daily-coding/src/tip/canvas-heatmap/</a></p>

<p>There is a demo page which you can test the api by clicking canvas:
<a href="http://www.flickr.com/photos/40741608@N08/4347650163/" title="canvas-raw by 贝小塔, on Flickr"><img src="http://farm3.static.flickr.com/2733/4347650163_ea740356e4_o.jpg" width="326" height="284" alt="canvas-raw" /></a>
then click heatmap button!
<a href="http://www.flickr.com/photos/40741608@N08/4348397874/" title="canvas2 by 贝小塔, on Flickr"><img src="http://farm3.static.flickr.com/2796/4348397874_8ac80b0756_o.jpg" width="314" height="275" alt="canvas2" /></a></p>

<p>This is the new year gift for my readers and my dear friends !</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/10/%E6%97%A0%E9%A2%98/">无题</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-10T00:00:00+08:00" pubdate data-updated="true">Feb 10<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>我草，这是真的吗，同志们是3:0吗？？！！</p>

<p>是不是电视显示错了？？！</p>

<p>我有生之年居然看到这一幕了！！！</p>

<p>人生啊，这是人生吗</p>

<p>见证历史了！！！</p>

<p>牛逼！！这是真的吗，这是他妈真的吗</p>

<p>邓卓翔！！</p>

<p>牛逼！！！</p>

<p>娘的，要下载录像</p>

<p>这他妈是真的吗？？！！</p>

<p>去你妈的CCTV</p>

<p>去你妈的江和平</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/08/suppressing-simple-xmls-class-attribute/">Suppressing Simple-xml&#8217;s Class Attribute</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-08T00:00:00+08:00" pubdate data-updated="true">Feb 8<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://simple.sourceforge.net" target="_blank">Simple-xml</a> is an object-xml serialization and de-serialization framework. It&#8217;s featured by annotation-driven, light-weight and self-contained.</p>

<p>In simple-xml, pojos that will be serialized are annotated with @Root, @Element, @Attribute or @Text. The problem is, when handling with inheritance, if the actual type is different from declared type, simple-xml will add a &#8220;class&#8221; attribute for de-serialization consideration. That is, the parser will use this attribute to determine the schema of the xml element. However, this is of no useful when we do not parse xml by simple-xml. And there is also risk that the class attribute exposes our program&#8217;s internal structure.</p>

<p>Take following code as example:
<pre class="brush:java">@Root
public class Response{
    @Element
    private Object entry;</pre></p>

<p>    // getter and setter &#8230;<br />
}</p>

<p>public class OrderItem{<br />
    @Element<br />
    private String name;</p>

<p>    // getter and setter &#8230;<br />
}
When you generate xml from classes above, you will have the entry element of response with an attribute &#8220;class&#8221;, which value is the qualified class name, like &#8220;package.OrderItem&#8221;.</p>

<p>This is done by simple-xml&#8217;s Strategy interface. By default, the Persister uses TreeStrategy which has an implementation of setElement like:
<pre class="brush:java">/**
 * This is used to attach a attribute to the provided element
 * that is used to identify the class. The attribute name is
 * "class" and has the value of the fully qualified class
 * name for the object provided. This will only be invoked
 * if the object class is different from the field class.
 *
 * @param type this is the declared class for the field used
 * @param value this is the instance variable being serialized
 * @param node this is the element used to represent the value
 * @param map this is used to maintain contextual information
 *
 * @return this returns true if serialization is complete
 */
public boolean setElement(Type type, Object value, NodeMap node, Map map){
    Class actual = value.getClass();
    Class expect = type.getType();
    Class real = actual;
    if(actual.isArray()) {
        real = setArray(expect, value, node);
    }
    if(actual != expect) {
        node.put(label, real.getName());
    }
    return false;
}</pre>
This is where class attributed. So to suppress the attribute, we simply override this method by inherit TreeStrategy. I take a inline class for convenience here.
<pre class="brush:java">Serializer s = new Persister(new TreeStrategy(){
    @Override
    public boolean setElement(Type type, Object value, NodeMap node, Map map){
        return false;
    }
});</pre>
Now it works, however, simple-xml won&#8217;t be able to deserialize xml generated by this modified strategy.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2010/02/07/%E4%BD%BF%E7%94%A8gnome-dictionary%E5%92%8Cdictd/">使用gnome-dictionary和dictd</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-02-07T00:00:00+08:00" pubdate data-updated="true">Feb 7<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>最近琢磨字典多一些，以前一直不知道gnome自带的gnome-dictionary如何使用，因为默认的字典源里都没有中文字典，而且离线更是无法使用。其实不然，字典服务可以自架，并且可以使用自己的字典。</p>

<p>在自己的机器上架设dictionary server，以ubuntu为例：</p>

<p>安装dictd / dict
<em>sudo apt-get install dictd dict</em></p>

<p>前者是字典服务器，后者是字典服务客户端。还可以从仓库里安装已经打包好的字典，如
<em>sudo apt-get install dict-stardic</em>
是一个英汉字典</p>

<p>dictd安装好后会默认自启动，也可以通过
<em>sudo service dictd start</em>
来控制dictd的启动、重启和关闭。</p>

<p>通过dict测试服务的状况
<em>dict -D</em>
命令会列出可用的数据库（即字典）</p>

<p>在gnome-dictionary中添加字典源 Edit-&gt;Preference-&gt;Source-&gt;Add<br />
Name: 自定义的字典名<br />
Transport: Dictionary Source<br />
Hostname: 127.0.0.1<br />
Port: 2628</p>

<p>Close之后可以到主界面打开侧边栏，在Dictionary Source中双击选定此字典，在Aailable Dictionaries里双击选中目标字典，于是就可以在gnome-dictionary里使用本地的字典服务了。</p>

<p>接下来安装自己的字典。stardict的<a href="http://stardict.sourceforge.net/Dictionaries_zh_CN.php">网站</a>上有很多中文字典，上面也都标示了授权协议。要在dictd里使用这些字典，需要进行一个简单的格式转换。安装一个工具
<em>sudo apt-get install dictconv</em></p>

<p><em>它的使用方法：<br />
dictconv -o OUTPUT_FILE INPUT_FILE</em></p>

<p>在input_file指定stardict的.ifo文件，在output_file指定要生成的dictd的.index文件。这个转换非常耗时，需要有足够的耐心。这个操作将会生成.index和.dict文件。对.dict文件进行压缩：
<em>dictzip OUT.dict</em></p>

<p>转换完成后，编辑<em>/var/lib/dictd/db.list</em>文件，在其中添加一个database定义
<em>database YOUR_DB_NAME{<br />
data PATH_TO_DICT_DZ<br />
index PATH_TO_INDEX<br />
}</em></p>

<p>其中PATH_TO_DICT_DZ是上一步的.dz文件，PATH_TO_INDEX是到上一步生成的.index文件的路径。编辑完成后，重启dictd服务
<em>sudo service dictd restart</em></p>

<p>使用dict -D可以查看启用的字典。</p>

<p>建议备份<em>/var/lib/dictd/db.list</em>文件，因为每次从apt-get安装字典后，这个文件都会被覆盖。</p>

<p>dictd服务也可以在fantasdic里访问。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/blog/page/27/">&larr; Older</a>
    
    <a href="/blog/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/blog/page/25/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/blog/2013/07/16/four-years-as-programmer/">工作四周年</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/07/05/grunt-for-requirejs-projects/">Grunt for Requirejs Projects</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/06/29/%E7%BB%99-raspberry-pi-%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%98%BE%E7%A4%BA-ip-%E7%9A%84%E6%B6%B2%E6%99%B6%E5%B1%8F/">给 Raspberry Pi 添加一个显示 IP 的液晶屏</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/06/07/%E7%BA%B8%E4%B8%8A%E5%BE%97%E6%9D%A5%E7%BB%88%E8%A7%89%E6%B5%85/">纸上得来终觉浅</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2013/04/24/checkout-ring-adapter-for-jetty-9/">Checkout Ring Adapter for Jetty 9</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/sunng87">@sunng87</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'sunng87',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/blog/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/classicing?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/classicing">My Delicious Bookmarks &raquo;</a></p>
</section>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Sun Ning -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'sunng-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
