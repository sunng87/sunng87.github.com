<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Setup a Jython Development Environment</title>
  <meta name="description" content="This article will show you some basic steps to setup a standalone environment for Jython, with the power of some popular and standard tools.">

  <link rel="stylesheet" href="/blog/css/main.css">
  <link rel="canonical" href="http://sunng.info//blog/blog/2010/12/30/setup-a-jython-development-environment/">
  <link rel="alternate" type="application/rss+xml" title="Here comes the Sun" href="http://sunng.info//blog/atom.xml" />
</head>

  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/blog/">Here comes the Sun</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

    </nav>

  </div>

</header>

    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Setup a Jython Development Environment</h1>
    <p class="post-meta">Dec 30, 2010</p>
  </header>

  <article class="post-content">
    <p>This article will show you some basic steps to setup a standalone environment for Jython, with the power of some popular and standard tools.</p>

<p><h3>0. Install essential tools</h3>
Take Ubuntu Maverick as an example, before starting, you have to make sure these packages installed on your system.</p>

<p><strong>Essential Python tools</strong> (Python is shipped with most Linux distribution by default)
<i>sudo apt-get install python-pip python-virtualenv</i></p>

<p><strong>Java</strong>
<i>sudo apt-get install openjdk-6-jdk openjdk-6-jre</i></p>

<p><strong>Jython</strong>
The Jython package in Ubuntu repository is obsolete. Download Jython installer from official website. A full installation is recommended here.
<a href="http://jython.org/downloads.html">http://jython.org/downloads.html</a></p>

<p>As an optional step, I often move Jython direcotry to /usr/local/share/ , and use a symbol link to add Jython to PATH:
<i>sudo ln -s /usr/local/share/jython/bin/jython /usr/local/bin/</i></p>

<p><strong>Install additional Java tools</strong>
<i>sudo apt-get install ant ivy</i></p>

<p><h3>1. Create a standalone environment</h3>
Jython 2.5 is fully compatible with virtualenv, so you can create a standalone environment just like what you do with python:
<i>virtualenv -p /usr/local/bin/jython jython-env</i>
<i>cd jython-env</i></p>

<p>List the directory, you will see these files and directories:
<ul>
<li>bin/</li>
<li>cachedir/</li>
<li>Lib/</li>
<li>jython.jar</li>
<li>registry</li>
</ul>
Source the activate script:
<i>source bin/activate</i></p>

<p><h3>2. Download and install python packages</h3>
Now the python environment is just ready, you can install python packages as you want. Install bottle, for example:
<i>pip install bottle</i></p>

<p><h3>3. Download and install Java dependencies</h3>
This is the different step. As you know, the most important feature of Jython is availability of Java libraries to Python code. So we need some additional tools to manage Java dependencies. Popular Java lifecycle management tool <strong>Maven</strong> is not suitable here, because Maven is tightly depends on its archetype. <strong>Gradle</strong> is also known as a powerful build tool with DSL support. However, Gradle uses Groovy as the scripting language to create build file. Bringing Groovy to a Jython project seems terribly strange.</p>

<p>So I prefer the traditional Ant way to manage dependencies. First of all, create a build file with following content:
<strong>build.xml</strong>
[cc lang="xml"]
<project xmlns:ivy="antlib:org.apache.ivy.ant" name="jython-env" default="resolve">
    <target name="resolve" description="retrieve dependencies">
        <ivy:retrieve pattern="javalib/[artifact]-[revision].[ext]" type="jar" />
    </target>
</project>
[/cc]</p>

<p>Then create an ivy xml to configure dependencies:
<strong>ivy.xml</strong>
[cc lang="xml"]
<ivy-module version="2.0">
    <info organisation="info.sunng" module="jython-env" />
    <dependencies>
        <dependency org="commons-lang" name="commons-lang" rev="2.5" />
    </dependencies>
</ivy-module>
[/cc]</p>

<p>Also, as an optional step, you can overwrite default settings to configure ivy to use maven local repository.
<strong>ivysettings.xml</strong>
[cc lang="xml"]
<ivy-settings>
    <settings defaultresolver="maven-or-not" />
    <resolvers>
        <chain name="maven-or-not" returnfirst="true">
            <filesystem name="maven-local" m2compatible="true" />
            <ibiblio name="ibiblio" m2compatible="true" />
        </chain>
    </resolvers>
</ivy-settings>
[/cc]</p>

<p>All done, now you can download everything. In Ubuntu, default ivy installation, you have to specify ivy path in ant command line:
<i>ant -lib /usr/share/java/ivy.jar</i></p>

<p>You will see jars in <i>javalib</i>.</p>

<p><h3>4. Reconfigure start up script</h3>
The default Jython start up script is not friendly to external Java dependencies. To include jars, you have to use such dirty command line parameters:
<i>jython -Dpython.path=javalib/commons-lang-2.5.jar:javalib/...</i></p>

<p>To get rid of this, first rename bin/jython to bin/startJython. (Follow the Groovy naming convention)</p>

<p>Then create a new bin/jython script wraps the old one:<br />
[cc lang="bash"]<br />
#! /bin/bash</p>

<p>JYTHON_CMD="startJython"<br />
JAVA_LIBS="javalib/*.jar"<br />
PYTHON_PATH=""</p>

<p>for lib in $JAVA_LIBS<br />
do<br />
    PYTHON_PATH="$PYTHON_PATH:$lib"<br />
done</p>

<p>#echo $PYTHON_PATH<br />
$JYTHON_CMD -Dpython.path=$PYTHON_PATH</p>

<p>[/cc]</p>

<p><h3>5. Run</h3>
Finally, it comes to an end. Type jython to execute the interactive shell:
<i>jython</i>
<blockquort>
Jython 2.5.1 (Release_2_5_1:6813, Sep 26 2009, 13:47:54)<br />
[OpenJDK Server VM (Sun Microsystems Inc.)] on java1.6.0_20<br />
Type "help", "copyright", "credits" or "license" for more information.<br />
>>> from org.apache.commons.lang import BitField<br />
>>> import bottle
</blockquort></p>

<p>Both Python and Java dependency is accessible. Now it's time to get your new start.</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Here comes the Sun</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Here comes the Sun</li>
          <li><a href="mailto:"></a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text"></p>
      </div>
    </div>

  </div>

</footer>

  </body>

</html>
