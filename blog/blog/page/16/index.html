
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Here comes the Sun</title>
  <meta name="author" content="Sun Ning">

  
  <meta name="description" content="pgpool是postgresql的中间件，他的主要功能包括： Connection Pooling 连接池
Replication 双写
Load Balance 负载均衡
Limiting Exceeding Connections 连接限制
Parallel Query 并行查询 除此以外， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://sunng87.github.io/blog//blog/page/16">
  <link href="/blog/favicon.png" rel="icon">
  <link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/blog/atom.xml" rel="alternate" title="Here comes the Sun" type="application/atom+xml">
  <script src="/blog/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/blog/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/blog/">Here comes the Sun</a></h1>
  
    <h2>Sun Ning's web log</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/blog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:sunng87.github.io/blog/" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/blog/">Blog</a></li>
  <li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/02/14/pgpoolii%E7%9A%84%E7%AE%A1%E7%90%86%E5%8A%9F%E8%83%BD/">pgpoolII的管理功能</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-14T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>pgpool是postgresql的中间件，他的主要功能包括：
<ul>
<li>Connection Pooling 连接池</li>
<li>Replication 双写</li>
<li>Load Balance 负载均衡</li>
<li>Limiting Exceeding Connections 连接限制</li>
<li>Parallel Query 并行查询</li>
</ul></p>

<p>除此以外，pgpool还提供了对数据库节点的健康检查功能，自动fail over。</p>

<p>对pgpool的管理，pgpool本身除了工作端口（默认5433）以外，还开放一个pcp端口9898，类似FTP的控制端口。通过pcp端口可以获取pgpool的运行时信息，也可以进行运行时的操作。这些功能罗列在：<br />
http://pgpool.projects.postgresql.org/pgpool-II/doc/pgpool-en.html#reference</p>

<p>封装这些命令的二进制文件也随着pgpool发行，由于是通过网络通信，所以并不要求这些工具与pgpool安装在同一台机器上。</p>

<p>除此以外，为了用户友好，pgpool还有一个具有UI的用户管理工具。这个工具的功能包括：
<ul>
<li>系统信息，主要是pcp的信息</li>
<li>配置文件编辑，这个功能似乎要求pgpooladmin和pgpool安装在一台机器上以便直接都写配置文件</li>
<li>切分规则编辑</li>
</ul></p>

<p>另外，pgpool还通过一些自定义的SQL语句允许用户从工作端口提取一些配置信息和运行时信息：<br />
http://pgpool.projects.postgresql.org/pgpool-II/doc/pgpool-en.html#show-commands</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/02/08/%E6%98%A5%E8%8A%82%E7%95%99%E5%BD%B1%EF%BC%8C%E7%89%9B/">春节留影，牛</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-08T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>家里有两头牛，准确说本来是一头，一个半月前添了新成员。仔细看，都是双眼皮。</p>

<p>瞧这一家子
<a href="http://www.flickr.com/photos/40741608@N08/5428020614/" title="DSC_0008 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5176/5428020614_d5f4b5083f.jpg" width="500" height="336" alt="DSC_0008" /></a></p>

<p>她是我们家的老成员了
<a href="http://www.flickr.com/photos/40741608@N08/5428021062/" title="DSC_0019 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5055/5428021062_c46b7471a5.jpg" width="336" height="500" alt="DSC_0019" /></a></p>

<p>小牛好像还没有长好牙，现在还不吃草，只是添添秸秆，饿了还是得找妈
<a href="http://www.flickr.com/photos/40741608@N08/5428021524/" title="DSC_0028 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5135/5428021524_c0bf0c060e.jpg" width="500" height="336" alt="DSC_0028" /></a></p>

<p>后面是第二次拍的，到这次的时候小牛已经认识我了，一点都不怕，镜头感十足
<a href="http://www.flickr.com/photos/40741608@N08/5427424857/" title="DSC_0078 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5018/5427424857_c98605f729.jpg" width="500" height="336" alt="DSC_0078" /></a></p>

<p>双眼皮，长睫毛，和你一样
<a href="http://www.flickr.com/photos/40741608@N08/5428028372/" title="DSC_0084 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5093/5428028372_5bfd43ee62.jpg" width="500" height="336" alt="DSC_0084" /></a></p>

<p>我最喜欢这张，已经用它做头像了
<a href="http://www.flickr.com/photos/40741608@N08/5427425847/" title="DSC_0086 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5179/5427425847_3e521300cd.jpg" width="500" height="336" alt="DSC_0086" /></a></p>

<p>也别光顾自己臭美，大牛妈妈还是要不停地吃草来养活这孩子
<a href="http://www.flickr.com/photos/40741608@N08/5428029332/" title="DSC_0087 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5093/5428029332_c5e79768c0.jpg" width="500" height="336" alt="DSC_0087" /></a></p>

<p>:-;
<a href="http://www.flickr.com/photos/40741608@N08/5428029732/" title="DSC_0088 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5217/5428029732_42c637c270.jpg" width="500" height="336" alt="DSC_0088" /></a></p>

<p>一头秀发
<a href="http://www.flickr.com/photos/40741608@N08/5428030234/" title="DSC_0095 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5015/5428030234_c24e5d25cf.jpg" width="500" height="336" alt="DSC_0095" /></a></p>

<p>狮子王？
<a href="http://www.flickr.com/photos/40741608@N08/5428030674/" title="DSC_0099 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5057/5428030674_9d998469c3.jpg" width="500" height="336" alt="DSC_0099" /></a></p>

<p><a href="http://www.flickr.com/photos/40741608@N08/5427427943/" title="DSC_0101 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5220/5427427943_5a23fa59a6.jpg" width="500" height="336" alt="DSC_0101" /></a></p>

<p>最后一张，英俊潇洒
<a href="http://www.flickr.com/photos/40741608@N08/5428031642/" title="DSC_0103 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5011/5428031642_5933e9c844.jpg" width="500" height="336" alt="DSC_0103" /></a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/02/08/%E6%98%A5%E8%8A%82%E7%95%99%E5%BD%B1%EF%BC%8C%E7%83%9F%E7%81%AB/">春节留影，烟火</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-08T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>村里能放烟花，是到了后几天才想起来的事。在妹妹的协助下实验了一把，ISO1600，快门优先半秒曝光</p>

<p><a href="http://www.flickr.com/photos/40741608@N08/5427422005/" title="DSC_0052 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5093/5427422005_a8f6e9f503.jpg" width="336" height="500" alt="DSC_0052" /></a></p>

<p><a href="http://www.flickr.com/photos/40741608@N08/5428025508/" title="DSC_0056 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5131/5428025508_ce400ba7a8.jpg" width="336" height="500" alt="DSC_0056" /></a></p>

<p><a href="http://www.flickr.com/photos/40741608@N08/5427422971/" title="DSC_0064 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5296/5427422971_75d3d2230c.jpg" width="336" height="500" alt="DSC_0064" /></a></p>

<p><a href="http://www.flickr.com/photos/40741608@N08/5428026548/" title="DSC_0066 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5017/5428026548_c3bbbf3b18.jpg" width="336" height="500" alt="DSC_0066" /></a></p>

<p><a href="http://www.flickr.com/photos/40741608@N08/5428026928/" title="DSC_0074 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5259/5428026928_f4d123382b.jpg" width="336" height="500" alt="DSC_0074" /></a></p>

<p><a href="http://www.flickr.com/photos/40741608@N08/5428027396/" title="DSC_0076 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5139/5428027396_96af163ab3.jpg" width="336" height="500" alt="DSC_0076" /></a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/02/08/%E6%98%A5%E8%8A%82%E7%95%99%E5%BD%B1%EF%BC%8C%E5%86%9C%E6%9D%91/">春节留影，农村</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-08T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>北方农村的冬天外屋凋敝满眼看不到一点绿色，空气里弥漫烧煤和烧秸秆的烟气。这个时候的夕阳还是很到位的。</p>

<p>来张逆光
<a href="http://www.flickr.com/photos/40741608@N08/5428019644/" title="DSC_0001 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5292/5428019644_5d56dc1a49.jpg" width="336" height="500" alt="DSC_0001" /></a></p>

<p>树上的鸟巢
<a href="http://www.flickr.com/photos/40741608@N08/5428020106/" title="DSC_0004 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5134/5428020106_e41b799d73.jpg" width="500" height="336" alt="DSC_0004" /></a></p>

<p>浓雾里的村中一角
<a href="http://www.flickr.com/photos/40741608@N08/5427420123/" title="DSC_0043 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5218/5427420123_80bd528a85.jpg" width="500" height="336" alt="DSC_0043" /></a></p>

<p>村道
<a href="http://www.flickr.com/photos/40741608@N08/5428024168/" title="DSC_0045 by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5053/5428024168_8d02d4d63c.jpg" width="336" height="500" alt="DSC_0045" /></a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/02/02/breaking-changes-in-compojure-0-6-0/">Breaking Changes in Compojure 0.6.0</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-02T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在compojure 0.6.0里，默认的middleware被移除了。因为还没有正式发布，所以网上几乎没有相关的文档说明，而0.5.x的例子已经没能正常工作了。</p>

<p>[cc lang=&#8221;clojure&#8221;]<br />
;&#8230;<br />
(defroutes root<br />
    (GET &#8220;/&#8221; {params :params} (str params)))</p>

<p>(run-jetty root {:port 8080}))<br />
[/cc]</p>

<p>这样在0.5.x中可以正确运行的代码，在0.6.0中params变成了空的map。</p>

<p>在0.6.0中，compojure引入了一个新的ns叫做compojure.handler，其中包含两个function， api和site，它们包含了一些默认的middleware，适合相应的开发场景。为了让代码能够工作，在新版本中：<br />
[cc lang=&#8221;clojure&#8221;]<br />
;&#8230;<br />
(use &#8216;compojure.handler)<br />
(defroutes root<br />
    (GET &#8220;/&#8221; {params :params} (str params)))</p>

<p>(def app (site root))</p>

<p>(run-jetty root {:port 8080}))<br />
[/cc]</p>

<p>详细可以在这里找到
<a href="https://groups.google.com/group/compojure/browse_thread/thread/4f8574d808ddf53e">https://groups.google.com/group/compojure/browse_thread/thread/4f8574d808ddf53e</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/01/22/%E5%8C%85%E7%AE%A1%E7%90%86%E4%B8%8E%E8%B7%AF%E5%BE%84%E7%AE%A1%E7%90%86/">包管理与路径管理</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-22T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>现在几乎每一种语言都有一些依赖管理工具，或者是中央的包仓库。比如这些：
<ul>
<li>Java: maven, ivy, gradle</li>
<li>Ruby: gems</li>
<li>Python: easy_install, pip</li>
<li>Clojure: leinigen</li>
<li>Groovy: maven, grape, gradle</li>
<li>Hashkell: cabal</li>
<li>PHP: pear</li>
<li>Nodejs: npm</li>
</ul></p>

<p>这些工具在管理包和路径时都会采用各不相同的策略，有的是通过自身实现，有的是借助语言平台本身的特点。</p>

<p><h3>Java</h3>
其中最注明的Maven，它的方式是在POM文件中定义你的依赖，Maven会在本地仓库中维护这些依赖。Maven的本地仓库默认是在$HOME/.m2/repository目录下，是用户独立的，当然要下载一个依赖也不需要root权限。而在通过Maven运行Java项目时，Maven插件会自动管理classpath，你并不需要把这些依赖从本地仓库里拷贝出来而单独维护一个所谓lib目录（这样也不好管理）。这是Maven的方式，目前看来，这也是最经典的一种方式。除了maven本身的特性以外，这也和Java的classpath机制有关。</p>

<p>最近势头很猛的Java构建工具gradle，方式也与Maven类似，它会把下载的依赖存放在$HOME/.gradle/cache目录里，并自动管理classpath。</p>

<p>同样是Java，与maven相对应的是ant+ivy。ivy可以为你管理依赖，但是ivy不会帮你管理classpath。ivy的包管理，是以project为scope的，你需要维护一个lib目录来存放这些下载的包，再通过传统的ant的方式去管理classpath，从而使项目可以进行编译和运行。</p>

<p>在Java世界里，还有一个特别的工具叫做grape，它是专门用于groovy的轻量级的依赖解决方案。grape是以脚本为scope，在需要依赖的脚本中通过@Grab声明依赖，grape工具可以从maven仓库中下载依赖到$HOME/.groovy/grapes中，并把相关的依赖加入groovy的classpath。除此以外，grape还有一个命令行工具帮助你手动下载依赖到本地仓库。grape的内部是基于ivy的，不过它的方式比ant要自动化很多。</p>

<p>在Java世界里还有一个特例，是Clojure的依赖管理工具leiningen。leiningen本身也比较简单，它的方式与ivy相同，会解析project.clj文件中定义的依赖关系，并下载到当前的工程目录下的lib中。lein是鼓励通过uberjar的方式把依赖统统打包的，所以它并没有classpath的管理功能。</p>

<p>总体来说，Java世界的工具和Java是相似的，其最大特点就是System independent，安装包不需要root权限，每次的运行都需要管理classpath。作为开发人员，classpath中有哪些可以访问的类库是可以控制的，这也使Java程序的移植性得到良好的控制和管理。</p>

<p><h3>Python</h3>
与Java不同，Python通常作为系统分发的一部分，他的包管理和PATH管理要相对混乱一些。通常我们有两种方式来安装一个Python的软件包：
<ul>
<li>sudo apt-get install python-redis</li>
<li>sudo easy_install redis</li>
</ul>
一种是通过系统的包管理工具（如apt-get）从系统的软件仓库里安装，一种是通过python自己的包管理工具（如easy_install / pip）从Python Cheese Shop中下载安装。这两种安装方式有什么不同呢。以Ubuntu为例，通过apt-get安装的python包通常会被放在 /usr/share/pyshared 或 /usr/lib/python2.6/dist-packages 中，相对应的，由easy_install安装的Python包，则存放在 /usr/local/lib/python2.6/dist-packages 中。Python启动后可以通过查看sys.path来了解当前的path情况。</p>

<p>除了安装到系统目录，easy_install可以通过 &#8211;user 选项来把软件包安装到用户目录 $HOME/.local/lib/python2.6/site-packages。不过无论是系统级别还是用户级别，python都很难在启动时管理Path，即任何时候python都可以访问安装在系统中的所有软件包。这导致了混乱的情况，导致编写的python软件难以进行依赖管理和移植（即使没有定义在setup.py中，很多依赖还是可以访问的）。</p>

<p>由此virtualenv营运而生，virtualenv帮助你创建一个独立的python运行环境。激活这个小环境之后，easy_install/pip仅仅安装软件到小环境，python仅能访问环境内部的site-packages，这样整个环境中的依赖关系就非常清楚，也保障了程序的移植性。这样，就将原本系统scope的python包管理级别改进为项目级别。我之前写的jip也是将依赖下载或拷贝到virtualenv的小环境中，并且修改jython的启动脚本修改PYTHONPATH的设置，保证Java依赖对Jython的透明可访问。</p>

<p><h3>Nodejs</h3>
nodejs是一个新兴的生态系统，一个包管理工具对其也是必不可少。npm是目前整个社区都比较认可的工具。</p>

<p>不过目前npm并不好用。npm默认会把自己安装到 node安装前缀的目录，比如node安装时你选择了默认前缀/usr/local，那么npm会把自己安装到/usr/local/lib/node里。这个目录是系统级别的，所以需要root权限，而npm本身又不鼓励用户用root权限来安装软件包（安全问题）。所以作者说希望用户把/usr/local/lib/node权限授予用户，或者把node安装到用户目录里。这两种方式其实都不太优雅。</p>

<p>Ruby的gems在这方面最符合unix哲学，即用户知道自己在做什么。如果用户以root权限运行gem  install，gem会把软件包安装到系统目录中对所有用户可用，而如果以普通用户权限运行，则安装到用户目录 $HOME/.gem 中仅当前用户可见。</p>

<p>nodejs在加载软件包时，会在require.paths中的几个目录里查找，前两个都是用户目录，所以npm也并非一定要把包安装到系统目录里去。虽然现在可以用过修改.npmrc文件在修改npm的默认行为，不过在这个CoC的时代，显然太繁琐了。</p>

<p><h3>Best Pratice</h3>
总结一下，包管理和路径管理的最佳实践应该是：语言平台有CoC的路径机制，包管理器有基于环境变量、用户权限的判断执行合适行为。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/01/14/update-on-exaile-soundmenu-indicator-and-exaile-doubanfm-plugin/">Update on Exaile-soundmenu-indicator and Exaile-doubanfm-plugin</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-14T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><h3>Exaile-soundmenu-indicator</h3>
As many users complaint about the &#8220;minimise to sound menu&#8221; issue, I updated exaile-soundmenu-indicator plugin. Now it is basically compliant with specification of <a href="https://wiki.ubuntu.com/SoundMenu">SoundMenu</a>: it will keep playing if you click the close button while the player is playing, and will exit if not playing. However, to be able to complete the functionality, you have to commentify the line <strong>1506</strong> of <strong>/usr/lib/exaile/xlgui/main.py</strong>, which is &#8221;<strong>return true</strong>&#8221; of method &#8221;<strong>delete_event</strong>&#8221; (On Ubuntu 10.10, exaile 0.3.2.0-ubuntu3). <strong>Otherwise</strong>, whenever you close the window it won&#8217;t exit.</p>

<p>I know this is a bad idea to require user to modify the source code, but it‘s not possible to override the behavior of a GTK callback, especially when you do not have the handler_id of the callback. If you do not mind the incompliant of closing behavior, you can just keep it as is, and exiting by menu and CRTL+Q.</p>

<p>Grab the snapshot of github repository to get the up-to-date version:
<a href="https://github.com/sunng87/Exaile-Soundmenu-Indicator">https://github.com/sunng87/Exaile-Soundmenu-Indicator</a></p>

<p><h3>Exaile-doubanfm-plugin</h3>
Exaile豆瓣电台插件更新。豆瓣最近调整了登录的策略：
<ul><li>用户在首次访问豆瓣时被设置cookie bid</li>
<li>用户提交登陆表单时被要求提交cookie bid，否则不予通过。</li></ul></p>

<p>此外，这次更新开始使用HTTPS提交用户登录信息。</p>

<p><a href="https://github.com/sunng87/exaile-doubanfm-plugin">https://github.com/sunng87/exaile-doubanfm-plugin</a>，请下载最新0.0.6c。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/01/12/html5-form-in-opera-11/">HTML5 Form in Opera 11</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-12T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>严格意义上我现在已经不能算是个web guy了，不过托Web开放的特性，咱也能评论一下。最近做个小的界面，考虑到要面向未来，HTML5又提供了丰富的表单增强。这些特性中，Firefox 3.6基本上还没有支持，Chromium 8.0有少部分支持，而真正支持比较完整的是Opera 11.</p>

<p><strong>autofocus</strong>
页面载入后自动将焦点转到某个input，就如以前的onload时候xxx.focus()</p>

<p><strong>required</strong>
指定某个input为必填，提交时会有validation，在Opera11里还会给你这样的警告并且禁止提交：
<a href="http://www.flickr.com/photos/40741608@N08/5349345730/" title="Screenshot - 01122011 - 10:53:41 PM by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5083/5349345730_f6696fd07e.jpg" width="329" height="144" alt="Screenshot - 01122011 - 10:53:41 PM" /></a></p>

<p><strong>email / url</strong>
指定某个input的特殊类型，提交时也会有对应的格式检查：
<a href="http://www.flickr.com/photos/40741608@N08/5348736441/" title="Screenshot - 01122011 - 10:54:41 PM by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5081/5348736441_78accc61ac.jpg" width="344" height="140" alt="Screenshot - 01122011 - 10:54:41 PM" /></a></p>

<p>这样的提示可能满足不了你的替用户着想的产品经理，但是你清楚他帮你省了多少事情。而且，在DiveInfoHtml5里提到，iphone甚至为这个input做了优化，在软件盘上把空格键变得很小（因为输入邮件地址用不着），并且提供了一个@键；这就是工程师的用户体验啊。</p>

<p><strong>placeholder</strong>
在input里显示提示文本：
<a href="http://www.flickr.com/photos/40741608@N08/5349345562/" title="Screenshot - 01122011 - 10:52:18 PM by 贝小塔, on Flickr"><img src="http://farm6.static.flickr.com/5209/5349345562_d658665b92.jpg" width="441" height="63" alt="Screenshot - 01122011 - 10:52:18 PM" /></a></p>

<p>注意到后面的红色星号了吗。这本来是我设计的一个workaround，既然Firefox 3都还不支持required validation，那么我们通过CSS来显示一个必填的提示：<br />
[cc lang=&#8221;css&#8221;]<br />
input[required=&#8221;required&#8221;]:after {<br />
	content: &#8216;(*)&#8217;;<br />
	color: #F00;<br />
}
[/cc]</p>

<p>结果这个伪类最后只有在Opera里实现了预期的效果，看<a href="http://stackoverflow.com/questions/2587669/css-after-pseudo-element-on-input-field">在Stackoverflow上的讨论</a>才得知input的:after和:before伪类只有Opera支持。</p>

<p>HTML5 Form这部分是一个真正务实的标准，你可以看到几乎每一个特性都是我们日常每时每刻都需要，几乎每个网站的JS都要实现的功能。标准是沟通上下游（浏览器和应用开发人员）的契约，一个真正反应相互需求的标准才是有实际价值的。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/01/08/soldat-gefr/">Soldat & Gefr</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-08T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>我的这一套stack正在走向完整。上次贴了一张soldat-http的图，现在基于soldat的wsgi服务器也已经有了一个基本可以运行的实现，名字叫做gefr（我的命名出处参考<a href="http://en.wikipedia.org/wiki/Rank_insignia_of_the_German_armed_forces">这里</a>）。现在gefr上已经可以跑基于bottle框架的wsgi程序了，也就是说一些基于python的web应用可能可以通过jython来运行在soldat上。为了搞定jython的环境，这几天我还花了不少时间做了jip帮我从maven仓库里自动下载依赖的jar包。</p>

<p>soldat和gefr的代码都放在我的bitbucket上：
<ul>
<li>soldat <a href="https://bitbucket.org/sunng/soldat">https://bitbucket.org/sunng/soldat</a></li>
<li>gefr <a href="https://bitbucket.org/sunng/gefr">https://bitbucket.org/sunng/gefr</a></li>
</ul></p>

<p>此外，这两个项目也分别发布到了<a href="https://oss.sonatype.org/content/repositories/snapshots/">sonatype oss仓库</a>和<a href="http://pypi.python.org/pypi/gefr">python cheese shop</a>。</p>

<p>现在还有几个问题：
<ul>
<li>soldat在读buffer的时候先获得buffer的limit，再去读相应长度的buffer有时会出现BufferUnderflowException。这个可能存在线程安全问题，现在还没发现。</li>
<li>gefr启动之后可以通过在jvisualvm里找到这个进程，但是绑定profiler之后很诡异的是gefr就不再处理请求了。</li>
<li>直接用soldat的处理http请求，吞吐量可以上万；但是在上面加上jython的gefr，再加上bottle框架，同样的功能吞吐量就剩下原来的十分之一了。就是因为没法做profile，所以还不知道时间花到哪里去了。</li>
</ul></p>

<p>简单地 announce 一下，这样我有更多的动力来继续把这两个小东西做好。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/blog/2011/01/04/jip-0-1/">Jip 0.1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-04T00:00:00+08:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The original idea is to create a standalone jython environment, I took <a href="http://sunng.info/blog/2010/12/setup-a-jython-development-environment/">traditional Java tools, ant and ivy</a>, to resolve Java dependencies. But  the XMLs seem to be verbose and not pythonic. So I decide to create something like pip, that is, resolves and installs dependencies in a pythonic way.  It is jip.</p>

<p>jip will automatically download jars and its <strong>non-optional</strong> <strong>runtime</strong> dependencies from Maven repositories. By default, jip will search your local repository and maven central repository for the requested artifact. Also, you can create a configuration file to overwrite this.</p>

<p>Virtualenv is required by jip. You must run jip within a standalone environment, created by virtualenv:
<i>virtualenv -p /usr/local/bin/jython jython-env</i>
<i>cd jython-env</i>
<i>source bin/activate</i></p>

<p>Don&#8217;t forget to activate it.</p>

<p>Then download jip with pip:
<i>pip install jip</i></p>

<p>Now you have pip for python and jip for java. To install a Java package, just type:<br />
jip install &lt;groupId&gt;:&lt;artifactId&gt;:&lt;version&gt;</p>

<p>groupId+artifactId+version is known as the coordinate of a maven artifact. For example, you need spring-core in your jython development:
<i>jip install org.springframework:spring-core:3.0.5.RELEASE</i></p>

<p>The jars will be stored in <i>javalib</i> directory:
<i>ls javalib</i>
<pre>
commons-logging-1.1.1.jar     spring-core-3.0.5.RELEASE.jar
spring-asm-3.0.5.RELEASE.jar
</pre></p>

<p>And When you installed jip, I will provide you a <i>jython-all</i> command to include dependencies by default. So use <i>jython-all</i> instead of <i>jython</i> to run your program and the shell.</p>

<p>For traditional Java user, there is a <i>resolve</i> subcommand to download dependencies defined in a pom file. This is more maintainable, some of you may prefer this way to typing it one by one.
<i>jip resolve pom.xml</i></p>

<p>To define custom repositories, place a dot file <i>.jip</i> in your home directory:<br />
[cc lang=&#8217;ini&#8217;]<br />
[jboss]<br />
uri=http://repository.jboss.org/maven2/<br />
type=remote</p>

<p>[local]<br />
uri=/home/sun/.m2/repository/<br />
type=local</p>

<p>[central]<br />
uri=http://repo1.maven.org/maven2/<br />
type=remote<br />
[/cc]<br />
You may have internal Nexus, just append to this file following the pattern.</p>

<p>Finally, a clean subcommand to remove everything you downloaded.</p>

<p>That&#8217;s all. You can find the project at:
<ul><li><a href="http://pypi.python.org/pypi/jip">http://pypi.python.org/pypi/jip</a></li>
<li><a href="https://github.com/sunng87/jip">https://github.com/sunng87/jip</a></li></ul></p>

<p>Your feedback is appreciate. Fire an issue in github if you find any bugs or new ideas about this tool.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/blog/page/17/">&larr; Older</a>
    
    <a href="/blog/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/blog/page/15/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>Ning Sun. Programmer. Map enthusiast. (<a href="http://sunng.info/">more</a>)</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/blog/2014/07/08/microservice-and-slacker-cluster/">Clojure Microservice Architecture With Slacker Cluster</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/07/07/new-android-apps/">Mapzei 和 观察者</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/07/01/extend-linux-ephemeral-ports/">扩展 Linux Ephemeral 端口限制</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/06/09/grouping-in-slacker-0-dot-12/">Slacker Cluster 0.12: Grouping</a>
      </li>
    
      <li class="post">
        <a href="/blog/blog/2014/05/27/fork-join-in-papaline/">Fork-Join in Papaline</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/sunng87">@sunng87</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'sunng87',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/blog/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>On Delicious</h1>
  <div id="delicious"></div>
  <script type="text/javascript" src="http://feeds.delicious.com/v2/json/classicing?count=3&amp;sort=date&amp;callback=renderDeliciousLinks"></script>
  <p><a href="http://delicious.com/classicing">My Delicious Bookmarks &raquo;</a></p>
</section>




  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Sun Ning -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'sunng-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
