<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Here Comes the Sun - Ning Sun</title>
        <link rel="stylesheet" href="https://sunng.info/blog/theme/css/main.css" />
        <link href="https://sunng.info/blog/atom.xml" type="application/atom+xml" rel="alternate" title="Here Comes the Sun Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://sunng.info/blog/">Here Comes the Sun </a></h1>
                <nav><ul>
                    <li><a href="https://sunng.info/blog/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->

                <section id="content" class="body">
                    <ol id="posts-list" class="hfeed" start="4">
            <li><article class="hentry">
                <header>
                    <h1><a href="https://sunng.info/blog/gong-zuo-di-er-nian.html" rel="bookmark"
                           title="Permalink to 工作第二年">工作第二年</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2011-07-18T00:00:00+08:00">
                Published: Mon 18 July 2011
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://sunng.info/blog/author/ning-sun.html">Ning Sun</a>
        </address>
<p>In <a href="https://sunng.info/blog/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->                <ul>
<li>当时
tags:</li>
<li>Life</li>
<li>work
published: true
comments: true</li>
</ul>
<hr />
<p><p><p>这个周末就是我正式工作两年的日子了，第二年过得稍微有些起伏，晚上写了一点总结。但是刚才读了一下觉得不太满意，也不太合适发出来。这样，即将跨入三年级的时候，我就改改风格谈谈愿望吧。</p>
<p>1. 把日常工作做好，积累技术，流程，项目管理的经验<br />
2. 业余时间拓展周边领域的知识：数据挖掘，数据分析，可视化方面<br />
3. 希望能主导去做成一点有始有终的事情<br />
4. 希望不久的将来能参与一个志同道合齐心协力（self-motivated）的团队一起做好一个产品</p></p></p>
                <a class="readmore" href="https://sunng.info/blog/gong-zuo-di-er-nian.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://sunng.info/blog/heatcanvas-support-for-leaflet.html" rel="bookmark"
                           title="Permalink to HeatCanvas support for Leaflet">HeatCanvas support for Leaflet</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2011-07-18T00:00:00+08:00">
                Published: Mon 18 July 2011
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://sunng.info/blog/author/ning-sun.html">Ning Sun</a>
        </address>
<p>In <a href="https://sunng.info/blog/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->                <ul>
<li>ANN
tags:</li>
<li>GIS</li>
<li>heatcanvas</li>
<li>javascript</li>
<li>map
published: true
comments: true</li>
</ul>
<hr />
<p><p><a href="http://leaflet.cloudmade.com/" title="leaflet" target="_blank">Leaflet</a> is a light weight web mapping library developed by <a href="http://cloudmade.com/" title="cloudmade" target="_blank">Cloudmade</a>. Leaflet is designed for compatibility with both desktop browser and mobile browser.</p></p>
<p>HeatCanvas-Leaflet extension enables heat map on Leaflet. You can create heat map layer and add it to ...</p>
                <a class="readmore" href="https://sunng.info/blog/heatcanvas-support-for-leaflet.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://sunng.info/blog/staged-event-driven-architecture.html" rel="bookmark"
                           title="Permalink to Staged Event-Driven Architecture">Staged Event-Driven Architecture</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2011-07-13T00:00:00+08:00">
                Published: Wed 13 July 2011
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://sunng.info/blog/author/ning-sun.html">Ning Sun</a>
        </address>
<p>In <a href="https://sunng.info/blog/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->                <ul>
<li>手艺
tags:</li>
<li>Architecture
published: true
comments: true</li>
</ul>
<hr />
<p><p>按照传统的编写应用程序的思路，当server接到请求，包装完成之后，分配到线程池中交给一个线程完成，返回。Java的servlet容器就是这么设计的，这么多年大部分的应用程序也是在这种模式下编写的。当任务的代价比较大，比如多次和数据库交互，并且可能和后端其他服务通信，这是线程被任务占用的时间就相对较长。如果请求的并发量很大，容器的线程池耗尽，新的请求就无法被处理，导致并发性无法提高，吞吐量也无法提高。</p></p>
<p>实际上在大部分应用程序里，所谓代价很高的任务，往往都是I/O Bound。涉及网络通信，磁盘读写，线程被迫wait，CPU却是空闲的。所以，I/O Bound的程序理论上都还有优化的空间。于是有了这种Staged Event-Driven Architecture，即SEDA。</p>

<p>SEDA的思路是将原先由一个线程完成的任务，分割为相对独立的多个阶段。每个阶段由专用的一组线程负责执行，阶段之间用过队列交互。又是上次提到的老话：If you cannot split it ...</p>
                <a class="readmore" href="https://sunng.info/blog/staged-event-driven-architecture.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://sunng.info/blog/zi-zhi-shan-zhai-mo-qia.html" rel="bookmark"
                           title="Permalink to 自制山寨摩卡">自制山寨摩卡</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2011-07-09T00:00:00+08:00">
                Published: Sat 09 July 2011
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://sunng.info/blog/author/ning-sun.html">Ning Sun</a>
        </address>
<p>In <a href="https://sunng.info/blog/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->                <ul>
<li>留影
tags:</li>
<li>coffee</li>
<li>Life
published: true
comments: true</li>
</ul>
<hr />
<p><p>一共也没去过几次咖啡店，但是几乎每次要的都是摩卡，感情特深。所谓摩卡就是不明颗粒+奶油(optional)+牛奶+咖啡+巧克力（排名分先后）。我晕，扯这些没用的干啥，先上图：
<a href="http://www.flickr.com/photos/40741608@N08/5921438312/" title="39171a47e65850f64ab50b4188e3c1846d177c05_wmeg_00001 by 贝小塔, on Flickr"><img src="http://farm7.static.flickr.com/6141/5921438312_459e4d874d.jpg" width="300" height="500" alt="39171a47e65850f64ab50b4188e3c1846d177c05_wmeg_00001" /></a></p></p>
<p>这是自制摩卡，奶油暂时还做不来，所以放弃了。不明颗粒太麻烦，就拿巧克力代替了。</p>

<p>值得一提的是这次的巧克力是从可可粉熬过来的。先拿一个小的奶锅装一点牛奶，待烧开以后加两勺可可粉和一定量的白糖，然后就在小火上搅拌即可。有点类似过去搅咖哩，你不搅它它必然糊掉。等到液体粘稠到一定程度以后出锅就可以了。在实际操作里，我的牛奶加多了，以至于最后也没有真正的粘稠，这个过程有待优化。如果觉得这个过程麻烦的同学，可以直接买巧克力酱，或者拿现成的巧克力熬。当然如果你从可可粉开始熬的话，可定制性更强一些。这个直接JDBC，或是用Hibernate类似。</p>

<p>出锅的巧克力放一边，凉了也不太要紧，我还滴了一点香草糖浆，不过似乎那味道只有在一开始，后来就消失了。</p>

<p>拿一个大一些的杯子 ...</p>
                <a class="readmore" href="https://sunng.info/blog/zi-zhi-shan-zhai-mo-qia.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://sunng.info/blog/failure-detection.html" rel="bookmark"
                           title="Permalink to Failure Detection">Failure Detection</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2011-07-03T00:00:00+08:00">
                Published: Sun 03 July 2011
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://sunng.info/blog/author/ning-sun.html">Ning Sun</a>
        </address>
<p>In <a href="https://sunng.info/blog/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->                <ul>
<li>手艺
tags:</li>
<li>algorithm</li>
<li>distribute
published: true
comments: true</li>
</ul>
<hr />
<p><p>分布式系统中检测节点的工作情况，最直观的方法是采用心跳包的方式，通过定时发送心跳包，如果对端节点没有正常返回，则认为此节点处在failure状态，这时系统需要采取一定的措施来保证正常运行。目前，Zookeeper就是采用这种方式（org.apache.zookeeper.ClientCnxn）。</p></p>
<p>但是为了避免由于网络抖动等等意外因素导致的误报，通常在心跳包的基础上做一些改进。我在盛大做服务的路由代理时，代理和后端的服务通过心跳包保持连接。当心跳包出现异常，或服务调用出现异常（类似HTTP 500的系统异常），代理会记录当时的时间戳。根据配置，代理会存储最近50次的时间戳，并且检查他们的方差，当方差小于一个阈值时，就认定服务为failure状态，将服务从列表中剔除并发送报警。在一些测试里，这套机制是可以按照预期工作的。可惜这个系统最后没有上生产系统，所以也没有实际的运维经验。</p>

<p>最近看到了Cassandra使用的Failure Detection机制，叫做Phi Failure Detection Model。这个思路在一定程度上跟我的方式类似，在Cassandra的实现里，他会存储最近1000次失败的信息（org.apache ...</p>
                <a class="readmore" href="https://sunng.info/blog/failure-detection.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
<p class="paginator">
        <a href="https://sunng.info/blog/author/ning-sun23.html">&laquo;</a>
    Page 24 / 78
        <a href="https://sunng.info/blog/author/ning-sun25.html">&raquo;</a>
</p>
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://sunng.info/blog/atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://github.com/sunng87">Github</a></li>
                            <li><a href="https://twitter.com/sunng">Twitter</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>